{"version":3,"file":"useAttendancePeriods-DfCT75w6.js","sources":["../../../../composables/useAttendancePeriods.ts"],"sourcesContent":["import type { \n    AttendancePeriod, \n    AttendancePeriodsResponse \n} from '@/types/attendance-period'\nimport { useAuthStore } from '@/stores/auth'\n\n// Helper to construct URL with tenant slug\nconst useTenantUrl = () => {\n    const route = useRoute()\n    const tenantSlug = route.params.tenant_slug as string\n    \n    return (path: string) => {\n      const cleanPath = path.startsWith('/') ? path : `/${path}`\n      return tenantSlug ? `/api/${tenantSlug}${cleanPath}` : `/api${cleanPath}`\n    }\n}\n\nexport const useAttendancePeriods = (\n    page: MaybeRef<number> = 1, \n    limit: MaybeRef<number> = 10, \n    search: MaybeRef<string> = '', \n    isActive: MaybeRef<string> = ''\n) => {\n    const getUrl = useTenantUrl()\n    const authStore = useAuthStore()\n\n    const queryParams = computed(() => {\n        const params: Record<string, any> = {\n            page: unref(page),\n            limit: unref(limit)\n        }\n        if (unref(search)) params.search = unref(search)\n        if (unref(isActive)) params.isActive = unref(isActive)\n        return params\n    })\n\n    const { data, pending, error, refresh } = useFetch<AttendancePeriodsResponse>(() => getUrl('/attendance-periods'), {\n        key: 'attendance-periods',\n        query: queryParams,\n        watch: [queryParams],\n        headers: computed(() => ({\n            Authorization: `Bearer ${authStore.token}`\n        }))\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useAttendancePeriod = (id: MaybeRef<string>) => {\n    const getUrl = useTenantUrl()\n    const authStore = useAuthStore()\n\n    const { data, pending, error, refresh } = useFetch<AttendancePeriod>(() => getUrl(`/attendance-periods/${unref(id)}`), {\n        key: `attendance-period-${unref(id)}`,\n        immediate: !!unref(id),\n        headers: computed(() => ({\n            Authorization: `Bearer ${authStore.token}`\n        }))\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useActivePeriod = () => {\n    const getUrl = useTenantUrl()\n    const authStore = useAuthStore()\n\n    const { data, pending, error, refresh } = useFetch<AttendancePeriod>(() => getUrl('/attendance-periods/active'), {\n        key: 'attendance-period-active',\n        headers: computed(() => ({\n            Authorization: `Bearer ${authStore.token}`\n        }))\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useCreateAttendancePeriod = () => {\n    const getUrl = useTenantUrl()\n    const authStore = useAuthStore()\n    const loading = ref(false)\n\n    const mutate = async (data: Omit<AttendancePeriod, 'id' | 'createdBy' | 'createdAt' | 'updatedAt'>) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl('/attendance-periods'), {\n                method: 'POST',\n                body: data,\n                headers: {\n                    Authorization: `Bearer ${authStore.token}`\n                }\n            })\n        } catch (error) {\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n\nexport const useUpdateAttendancePeriod = () => {\n    const getUrl = useTenantUrl()\n    const authStore = useAuthStore()\n    const loading = ref(false)\n\n    const mutate = async (id: string, data: Partial<AttendancePeriod>) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl(`/attendance-periods/${id}`), {\n                method: 'PATCH',\n                body: data,\n                headers: {\n                    Authorization: `Bearer ${authStore.token}`\n                }\n            })\n        } catch (error) {\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n\nexport const useDeleteAttendancePeriod = () => {\n    const getUrl = useTenantUrl()\n    const authStore = useAuthStore()\n    const loading = ref(false)\n\n    const mutate = async (id: string) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl(`/attendance-periods/${id}`), {\n                method: 'DELETE',\n                headers: {\n                    Authorization: `Bearer ${authStore.token}`\n                }\n            })\n        } catch (error) {\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n"],"names":[],"mappings":"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"}