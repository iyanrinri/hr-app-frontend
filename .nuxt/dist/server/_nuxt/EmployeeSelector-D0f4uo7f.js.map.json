{"file":"EmployeeSelector-D0f4uo7f.js","mappings":";;;;;AAUA,MAAM,eAAe,MAAM;AACvB,QAAM,QAAQ,SAAA;AACd,QAAM,aAAa,MAAM,OAAO;AAEhC,SAAO,CAAC,SAAiB;AACvB,UAAM,YAAY,KAAK,WAAW,GAAG,IAAI,OAAO,IAAI,IAAI;AACxD,WAAO,aAAa,QAAQ,UAAU,GAAG,SAAS,KAAK,OAAO,SAAS;AAAA,EACzE;AACJ;AAEO,MAAM,eAAe,CACxB,OAAyB,GACzB,QAA0B,IAC1B,SAA2B,IAC3B,SAA2B,OAC1B;AACD,QAAM,SAAS,aAAA;AAEf,QAAM,cAAc,SAAS,MAAM;AAC/B,UAAM,SAA8B;AAAA,MAChC,WAAW;AAAA,MACX,MAAM,MAAM,IAAI;AAAA,MAChB,OAAO,MAAM,KAAK;AAAA,IAAA;AAEtB,QAAI,MAAM,MAAM,EAAG,QAAO,SAAS,MAAM,MAAM;AAC/C,QAAI,MAAM,MAAM,EAAG,QAAO,SAAS,MAAM,MAAM;AAC/C,WAAO;AAAA,EACX,CAAC;AAED,QAAM,EAAE,MAAM,SAAS,OAAO,QAAA,IAAY,SAA4B,MAAM,OAAO,YAAY,GAAG;AAAA,IAC9F,KAAK;AAAA,IACL,OAAO;AAAA,IACP,OAAO,CAAC,WAAW;AAAA,EAAA,gBACtB;AAED,SAAO;AAAA,IACH;AAAA,IACA,SAAS;AAAA,IACT;AAAA,IACA;AAAA,EAAA;AAER;;;;;;;;;ACtCA,UAAM,YAAY,aAAA;AAClB,UAAM,OAAO,SAAS,MAAM,UAAU,IAAI;AAG1C,UAAM,EAAE,MAAM,SAAA,IAAa,aAAa,GAAG,GAAG;AAE9C,UAAM,YAAY,SAAS,MAAM,SAAS,OAAO,QAAQ,EAAE;AAE3D,UAAM,eAAe,SAAS,MAAM;AAChC,UAAI,CAAC,KAAK,MAAO,QAAO;AACxB,aAAO,CAAC,MAAM,SAAS,OAAO,EAAE,SAAS,KAAK,MAAM,IAAI;AAAA,IAC5D,CAAC;;UASY,aAAA,OAAY;qBAAEA,eAAAC,WAAA,EAAA,OAAM,YAAQ,MAAA,CAAA,qHAM9BC,cAAA,SAAO,QAAA,UAAU;AAMGC,sBAAA,UAAA,QAAZ,aAAQ;wCAEd,SAAO,SAAS,EAAE,KAEhBC,eAAA,SAAS,SAAS,KAAOA,eAAA,SAAS,QAAQ,qBAAQ,SAAS,KAAK,KAAK;;;;;;;;;;;;;;;","names":["_ssrRenderAttrs","_mergeProps","_ssrRenderAttr","_ssrRenderList","_ssrInterpolate"],"sources":["../../../../composables/useEmployees.ts","../../../../components/attendance/EmployeeSelector.vue"],"sourcesContent":["import type { \n    Employee, \n    EmployeesResponse, \n    CreateEmployeePayload, \n    AssignManagerPayload,\n    AssignSubordinatesPayload,\n    OrganizationTreeResponse\n} from '@/types/employee'\n\n// Helper to construct URL with tenant slug\nconst useTenantUrl = () => {\n    const route = useRoute()\n    const tenantSlug = route.params.tenant_slug as string\n    \n    return (path: string) => {\n      const cleanPath = path.startsWith('/') ? path : `/${path}`\n      return tenantSlug ? `/api/${tenantSlug}${cleanPath}` : `/api${cleanPath}`\n    }\n}\n\nexport const useEmployees = (\n    page: MaybeRef<number> = 1, \n    limit: MaybeRef<number> = 10, \n    search: MaybeRef<string> = '', \n    status: MaybeRef<string> = ''\n) => {\n    const getUrl = useTenantUrl()\n\n    const queryParams = computed(() => {\n        const params: Record<string, any> = {\n            paginated: 1,\n            page: unref(page),\n            limit: unref(limit)\n        }\n        if (unref(search)) params.search = unref(search)\n        if (unref(status)) params.status = unref(status)\n        return params\n    })\n\n    const { data, pending, error, refresh } = useFetch<EmployeesResponse>(() => getUrl('/employees'), {\n        key: 'employees',\n        query: queryParams,\n        watch: [queryParams] \n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useAllEmployees = () => {\n    const getUrl = useTenantUrl()\n\n    const { data, pending, error, refresh } = useFetch<EmployeesResponse>(() => getUrl('/employees'), {\n        key: 'all-employees',\n        query: { paginated: 0 }\n    })\n\n    // Helper to get raw array since API might return { data: [...] } or just [...] depend on implementation\n    const employees = computed(() => {\n        if (!data.value) return []\n        if (Array.isArray(data.value)) return data.value\n        return data.value.data || []\n    })\n\n    return {\n        data: employees,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useEmployee = (id: MaybeRef<string>) => {\n    const getUrl = useTenantUrl()\n\n    const { data, pending, error, refresh } = useFetch<Employee>(() => getUrl(`/employees/${unref(id)}`), {\n        key: `employee-${unref(id)}`,\n        immediate: !!unref(id)\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useCreateEmployee = () => {\n    const getUrl = useTenantUrl()\n    const loading = ref(false)\n\n    const mutate = async (payload: CreateEmployeePayload) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl('/employees'), {\n                method: 'POST',\n                body: payload\n            })\n            // Could invalidate queries here if we were using a global query cache\n        } catch (error) {\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n\nexport const useUpdateEmployee = () => {\n    const getUrl = useTenantUrl()\n    const loading = ref(false)\n\n    const mutate = async (id: string, payload: Partial<Employee>) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl(`/employees/${id}`), {\n                method: 'PUT',\n                body: payload\n            })\n        } catch (error) {\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n\nexport const useDeleteEmployee = () => {\n    const getUrl = useTenantUrl()\n    const loading = ref(false)\n\n    const mutate = async (id: string) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl(`/employees/${id}`), {\n                method: 'DELETE'\n            })\n        } catch (error) {\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n\nexport const useRestoreEmployee = () => {\n     const getUrl = useTenantUrl()\n     const loading = ref(false)\n \n     const mutate = async (id: string) => {\n         loading.value = true\n         try {\n             await $fetch(getUrl(`/employees/${id}/restore`), {\n                 method: 'PATCH'\n             })\n         } catch (error) {\n             throw error\n         } finally {\n             loading.value = false\n         }\n     }\n \n     return {\n         mutate,\n         loading\n     }\n }\n","<script setup lang=\"ts\">\nimport { useAuthStore } from '@/stores/auth'\nimport { useEmployees } from '@/composables/useEmployees'\nimport { computed } from 'vue'\n\nconst props = defineProps<{\n  modelValue: string\n}>()\n\nconst emit = defineEmits<{\n  (e: 'update:modelValue', value: string): void\n}>()\n\nconst authStore = useAuthStore()\nconst user = computed(() => authStore.user)\n\n// Get all employees for selector (limit 100 for now)\nconst { data: response } = useEmployees(1, 100)\n\nconst employees = computed(() => response.value?.data || [])\n\nconst isAuthorized = computed(() => {\n    if (!user.value) return false\n    return ['HR', 'SUPER', 'ADMIN'].includes(user.value.role)\n})\n\nconst handleChange = (event: Event) => {\n    const target = event.target as HTMLSelectElement\n    emit('update:modelValue', target.value)\n}\n</script>\n\n<template>\n  <div v-if=\"isAuthorized\" class=\"w-full\">\n    <label class=\"block text-sm font-bold text-gray-900 mb-2\">\n      Select Employee\n    </label>\n    <div class=\"relative\">\n        <select\n          :value=\"modelValue\"\n          @change=\"handleChange\"\n          class=\"w-full appearance-none px-4 py-2 pr-10 border border-gray-600 rounded-md focus:outline-none focus:ring-brand-cyan focus:border-brand-cyan bg-white text-black cursor-pointer\"\n        >\n          <option value=\"\">All Employees</option>\n          <option \n            v-for=\"employee in employees\" \n            :key=\"employee.id\" \n            :value=\"employee.id\"\n          >\n            {{ employee.firstName }} {{ employee.lastName }} ({{ employee.user.email }})\n          </option>\n        </select>\n        <div class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n            <svg class=\"h-4 w-4 fill-current\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\">\n                <path d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" />\n            </svg>\n        </div>\n    </div>\n  </div>\n</template>\n"],"version":3}