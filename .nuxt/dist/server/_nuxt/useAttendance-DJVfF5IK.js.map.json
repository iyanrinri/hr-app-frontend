{"file":"useAttendance-DJVfF5IK.js","mappings":"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","names":[],"sources":["../../../../composables/useAttendance.ts"],"sourcesContent":["import type { Attendance, AttendanceHistory, AttendanceStats, ClockInOutPayload, TodayAttendanceDashboard } from '@/types/attendance'\n\n\n// Helper to construct URL with tenant slug\nconst useTenantUrl = () => {\n  const route = useRoute()\n  const tenantSlug = route.params.tenant_slug as string\n  \n  return (path: string) => {\n    // Ensure path starts with /\n    const cleanPath = path.startsWith('/') ? path : `/${path}`\n    return tenantSlug ? `/api/${tenantSlug}${cleanPath}` : `/api${cleanPath}`\n  }\n}\n\nexport const useClockIn = () => {\n  const getUrl = useTenantUrl()\n\n  const loading = ref(false)\n  \n  const mutate = async (payload: ClockInOutPayload) => {\n    loading.value = true\n    try {\n      const data = await $fetch(getUrl('/attendance/clock-in'), {\n        method: 'POST',\n        body: payload,\n\n      })\n      return data\n    } catch (error: any) {\n      throw error\n    } finally {\n      loading.value = false\n    }\n  }\n\n  return {\n    mutate,\n    loading\n  }\n}\n\nexport const useClockOut = () => {\n  const getUrl = useTenantUrl()\n\n  const loading = ref(false)\n\n  const mutate = async (payload: ClockInOutPayload) => {\n    loading.value = true\n    try {\n      const data = await $fetch(getUrl('/attendance/clock-out'), {\n        method: 'POST',\n        body: payload,\n\n      })\n      return data\n    } catch (error: any) {\n      throw error\n    } finally {\n      loading.value = false\n    }\n  }\n\n  return {\n    mutate,\n    loading\n  }\n}\n\nexport const useTodayAttendance = () => {\n  const getUrl = useTenantUrl()\n\n  \n  const { data, pending, error, refresh } = useFetch<Attendance>(() => getUrl('/attendance/today'), {\n    key: 'attendance-today',\n    server: false\n  })\n  \n  return {\n    data,\n    loading: pending,\n    error,\n    refresh\n  }\n}\n\nexport const useAttendanceStats = (\n  startDate: MaybeRef<string>, \n  endDate: MaybeRef<string>, \n  employeeId: MaybeRef<string> = ''\n) => {\n  const getUrl = useTenantUrl()\n\n\n  const { data, pending, error, refresh } = useFetch<AttendanceStats>(() => getUrl('/attendance/stats'), {\n    key: 'attendance-stats',\n    query: {\n        startDate,\n        endDate,\n        employeeId\n    },\n    immediate: !!(unref(startDate) && unref(endDate)),\n    server: false\n  })\n  \n  return {\n    data,\n    loading: pending,\n    error,\n    refresh\n  }\n}\n\nexport const useAttendanceHistory = (\n    page: MaybeRef<number>,\n    limit: MaybeRef<number>,\n    filters: {\n        startDate?: MaybeRef<string>,\n        endDate?: MaybeRef<string>,\n        employeeId?: MaybeRef<string>,\n        status?: MaybeRef<string>\n    } = {}\n) => {\n    const getUrl = useTenantUrl()\n\n\n    const queryParams = computed(() => {\n        const params: Record<string, any> = {\n            page: unref(page),\n            limit: unref(limit)\n        }\n\n        const start = unref(filters.startDate)\n        if (start) {\n             // Append T00:00:00Z if it's just YYYY-MM-DD\n             params.startDate = start.includes('T') ? start : new Date(start).toISOString()\n        }\n\n        const end = unref(filters.endDate)\n        if (end) {\n             // Append T23:59:59Z if needed or just ISO\n             params.endDate = end.includes('T') ? end : new Date(end).toISOString()\n        }\n\n        const eId = unref(filters.employeeId)\n        if (eId) params.employeeId = eId\n\n        const s = unref(filters.status)\n        if (s) params.status = s\n\n        return params\n    })\n\n    const { data, pending, refresh, error } = useFetch<AttendanceHistory>(() => getUrl('/attendance/history'), {\n        key: 'attendance-history',\n        query: queryParams,\n        server: false\n    })\n\n    return {\n        data,\n        loading: pending,\n        refresh,\n        error\n    }\n}\n\nexport const useTodayAttendanceDashboard = () => {\n    const getUrl = useTenantUrl()\n\n    \n    const { data, pending, error, refresh } = useFetch<TodayAttendanceDashboard>(() => getUrl('/attendance/dashboard/today'), {\n        key: 'attendance-dashboard-today',\n        server: false\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n"],"version":3}