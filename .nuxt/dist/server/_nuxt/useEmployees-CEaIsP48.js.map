{"version":3,"file":"useEmployees-CEaIsP48.js","sources":["../../../../composables/useEmployees.ts"],"sourcesContent":["import type { \n    Employee, \n    EmployeesResponse, \n    CreateEmployeePayload, \n    AssignManagerPayload,\n    AssignSubordinatesPayload,\n    OrganizationTreeResponse\n} from '@/types/employee'\n\n\n// Helper to construct URL with tenant slug\nconst useTenantUrl = () => {\n    const route = useRoute()\n    const tenantSlug = route.params.tenant_slug as string\n    \n    return (path: string) => {\n      const cleanPath = path.startsWith('/') ? path : `/${path}`\n      return tenantSlug ? `/api/${tenantSlug}${cleanPath}` : `/api${cleanPath}`\n    }\n}\n\nexport const useEmployees = (\n    page: MaybeRef<number> = 1, \n    limit: MaybeRef<number> = 10, \n    search: MaybeRef<string> = '', \n    status: MaybeRef<string> = ''\n) => {\n    const getUrl = useTenantUrl()\n\n\n    const queryParams = computed(() => {\n        const params: Record<string, any> = {\n            paginated: 1,\n            page: unref(page),\n            limit: unref(limit)\n        }\n        if (unref(search)) params.search = unref(search)\n        if (unref(status)) params.status = unref(status)\n        return params\n    })\n\n    const { data, pending, error, refresh } = useFetch<EmployeesResponse>(() => getUrl('/employees'), {\n        key: 'employees',\n        query: queryParams,\n        watch: [queryParams],\n        server: false\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useAllEmployees = () => {\n    const getUrl = useTenantUrl()\n\n\n    // Stable query parameters\n    const queryParams = { paginated: 0 }\n\n    const { data, pending, error, refresh } = useFetch<EmployeesResponse>(() => getUrl('/employees'), {\n        key: 'all-employees',\n        query: queryParams,\n        server: false\n    })\n\n    // Helper to get raw array since API might return { data: [...] } or just [...] depend on implementation\n    const employees = computed(() => {\n        if (!data.value) return []\n        if (Array.isArray(data.value)) return data.value\n        return data.value.data || []\n    })\n\n    return {\n        data: employees,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useEmployee = (id: MaybeRef<string>) => {\n    const getUrl = useTenantUrl()\n\n\n    const { data, pending, error, refresh } = useFetch<Employee>(() => getUrl(`/employees/${unref(id)}`), {\n        key: `employee-${unref(id)}`,\n        immediate: !!unref(id),\n        server: false\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useCreateEmployee = () => {\n    const getUrl = useTenantUrl()\n\n    const loading = ref(false)\n\n    const mutate = async (payload: CreateEmployeePayload) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl('/employees'), {\n                method: 'POST',\n                body: payload,\n\n            })\n        } catch (error) {\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n\nexport const useUpdateEmployee = () => {\n    const getUrl = useTenantUrl()\n\n    const loading = ref(false)\n\n    const mutate = async (id: string, payload: Partial<Employee>) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl(`/employees/${id}`), {\n                method: 'PUT',\n                body: payload,\n\n            })\n        } catch (error) {\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n\nexport const useDeleteEmployee = () => {\n    const getUrl = useTenantUrl()\n\n    const loading = ref(false)\n\n    const mutate = async (id: string) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl(`/employees/${id}`), {\n                method: 'DELETE',\n\n            })\n        } catch (error) {\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n\nexport const useRestoreEmployee = () => {\n     const getUrl = useTenantUrl()\n\n     const loading = ref(false)\n \n     const mutate = async (id: string) => {\n         loading.value = true\n         try {\n             await $fetch(getUrl(`/employees/${id}/restore`), {\n                 method: 'PATCH',\n\n             })\n         } catch (error) {\n             throw error\n         } finally {\n             loading.value = false\n         }\n     }\n \n     return {\n         mutate,\n         loading\n     }\n }\n\n// --- Hierarchy Management Hooks ---\n\nexport const useAssignManager = () => {\n    const getUrl = useTenantUrl()\n\n    const loading = ref(false)\n\n    const mutate = async (id: string, data: AssignManagerPayload) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl(`/employees/${id}/manager`), {\n                method: 'PUT',\n                body: data,\n\n            })\n        } catch (error) {\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n\nexport const useAssignSubordinates = () => {\n    const getUrl = useTenantUrl()\n\n    const loading = ref(false)\n\n    const mutate = async (id: string, data: AssignSubordinatesPayload) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl(`/employees/${id}/subordinates`), {\n                method: 'POST',\n                body: data,\n\n            })\n        } catch (error) {\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n\nexport const useManagementChain = (id: MaybeRef<string>) => {\n    const getUrl = useTenantUrl()\n\n\n    const { data, pending, error, refresh } = useFetch<Employee[]>(() => getUrl(`/employees/${unref(id)}/management-chain`), {\n        key: `employee-chain-${unref(id)}`,\n        immediate: !!unref(id),\n        server: false\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useSubordinates = (id: MaybeRef<string>) => {\n    const getUrl = useTenantUrl()\n\n\n    const { data, pending, error, refresh } = useFetch<Employee[]>(() => getUrl(`/employees/${unref(id)}/subordinates`), {\n        key: `employee-subordinates-${unref(id)}`,\n        immediate: !!unref(id),\n        server: false\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useOrganizationTree = (id: MaybeRef<string>) => {\n    const getUrl = useTenantUrl()\n\n\n    const { data, pending, error, refresh } = useFetch<OrganizationTreeResponse>(() => getUrl(`/employees/${unref(id)}/organization-tree`), {\n        key: `employee-tree-${unref(id)}`,\n        immediate: !!unref(id),\n        server: false\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n"],"names":[],"mappings":"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"}