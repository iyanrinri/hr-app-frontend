{"version":3,"file":"usePayslips-toysh2Fm.js","sources":["../../../../composables/usePayslips.ts"],"sourcesContent":["import type { \n    Payslip, \n    GeneratePayslipRequest, \n    PayslipListResponse \n} from '@/types/payslip'\n\nconst useTenantUrl = () => {\n    const route = useRoute()\n    const tenantSlug = route.params.tenant_slug as string\n    \n    return (path: string) => {\n      const cleanPath = path.startsWith('/') ? path : `/${path}`\n      return tenantSlug ? `/api/${tenantSlug}${cleanPath}` : `/api${cleanPath}`\n    }\n}\n\nexport const usePayslips = (filters: MaybeRef<any> = {}) => {\n    const getUrl = useTenantUrl()\n\n    const queryParams = computed(() => {\n        const f = unref(filters)\n        return { ...f }\n    })\n\n    const { data, pending, error, refresh } = useFetch<PayslipListResponse>(() => getUrl('/payslip'), {\n        key: 'payslips',\n        query: queryParams,\n        watch: [queryParams],\n        server: false\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const usePayslip = (id: MaybeRef<string>) => {\n    const getUrl = useTenantUrl()\n\n    const { data, pending, error, refresh } = useFetch<Payslip>(() => getUrl(`/payslip/${unref(id)}`), {\n        key: `payslip-${unref(id)}`,\n        immediate: !!unref(id),\n        server: false\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useMyPayslips = () => {\n    const getUrl = useTenantUrl()\n\n    const { data, pending, error, refresh } = useFetch<Payslip[]>(() => getUrl('/payslip/my/history'), {\n        key: 'my-payslips',\n        server: false\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useGeneratePayslip = () => {\n    const getUrl = useTenantUrl()\n    const loading = ref(false)\n\n    const mutate = async (payload: GeneratePayslipRequest, options?: { onSuccess?: (data: Payslip) => void, onError?: (error: any) => void }) => {\n        loading.value = true\n        try {\n            const res = await $fetch<Payslip>(getUrl('/payslip/generate'), {\n                method: 'POST',\n                body: payload\n            })\n            if (options?.onSuccess) options.onSuccess(res)\n        } catch (error) {\n            if (options?.onError) options.onError(error)\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n\nexport const usePayslipByPayroll = (payrollId: MaybeRef<string>) => {\n    const getUrl = useTenantUrl()\n\n    const { data, pending, error, refresh } = useFetch<Payslip>(() => getUrl(`/payslip/by-payroll/${unref(payrollId)}`), {\n        key: `payslip-payroll-${unref(payrollId)}`,\n        immediate: !!unref(payrollId),\n        server: false\n    })\n\n    return {\n        data,\n        loading: pending,\n        error,\n        refresh\n    }\n}\n\nexport const useDeletePayslip = () => {\n    const getUrl = useTenantUrl()\n    const loading = ref(false)\n\n    const mutate = async (id: string, options?: { onSuccess?: () => void, onError?: (error: any) => void }) => {\n        loading.value = true\n        try {\n            await $fetch(getUrl(`/payslip/${id}`), {\n                method: 'DELETE'\n            })\n            if (options?.onSuccess) options.onSuccess()\n        } catch (error) {\n            if (options?.onError) options.onError(error)\n            throw error\n        } finally {\n            loading.value = false\n        }\n    }\n\n    return {\n        mutate,\n        loading\n    }\n}\n"],"names":[],"mappings":";;;AAMA,MAAM,eAAe,MAAM;AACvB,QAAM,QAAQ,SAAA;AACd,QAAM,aAAa,MAAM,OAAO;AAEhC,SAAO,CAAC,SAAiB;AACvB,UAAM,YAAY,KAAK,WAAW,GAAG,IAAI,OAAO,IAAI,IAAI;AACxD,WAAO,aAAa,QAAQ,UAAU,GAAG,SAAS,KAAK,OAAO,SAAS;AAAA,EACzE;AACJ;AAEO,MAAM,cAAc,CAAC,UAAyB,OAAO;AACxD,QAAM,SAAS,aAAA;AAEf,QAAM,cAAc,SAAS,MAAM;AAC/B,UAAM,IAAI,MAAM,OAAO;AACvB,WAAO,EAAE,GAAG,EAAA;AAAA,EAChB,CAAC;AAED,QAAM,EAAE,MAAM,SAAS,OAAO,QAAA,IAAY,SAA8B,MAAM,OAAO,UAAU,GAAG;AAAA,IAC9F,KAAK;AAAA,IACL,OAAO;AAAA,IACP,OAAO,CAAC,WAAW;AAAA,IACnB,QAAQ;AAAA,EAAA,gBACX;AAED,SAAO;AAAA,IACH;AAAA,IACA,SAAS;AAAA,IACT;AAAA,IACA;AAAA,EAAA;AAER;AAEO,MAAM,aAAa,CAAC,OAAyB;AAChD,QAAM,SAAS,aAAA;AAEf,QAAM,EAAE,MAAM,SAAS,OAAO,YAAY,SAAkB,MAAM,OAAO,YAAY,MAAM,EAAE,CAAC,EAAE,GAAG;AAAA,IAC/F,KAAK,WAAW,MAAM,EAAE,CAAC;AAAA,IACzB,WAAW,CAAC,CAAC,MAAM,EAAE;AAAA,IACrB,QAAQ;AAAA,EAAA,gBACX;AAED,SAAO;AAAA,IACH;AAAA,IACA,SAAS;AAAA,IACT;AAAA,IACA;AAAA,EAAA;AAER;AAEO,MAAM,gBAAgB,MAAM;AAC/B,QAAM,SAAS,aAAA;AAEf,QAAM,EAAE,MAAM,SAAS,OAAO,QAAA,IAAY,SAAoB,MAAM,OAAO,qBAAqB,GAAG;AAAA,IAC/F,KAAK;AAAA,IACL,QAAQ;AAAA,EAAA,gBACX;AAED,SAAO;AAAA,IACH;AAAA,IACA,SAAS;AAAA,IACT;AAAA,IACA;AAAA,EAAA;AAER;AAEO,MAAM,qBAAqB,MAAM;AACpC,QAAM,SAAS,aAAA;AACf,QAAM,UAAU,IAAI,KAAK;AAEzB,QAAM,SAAS,OAAO,SAAiC,YAAsF;AACzI,YAAQ,QAAQ;AAChB,QAAI;AACA,YAAM,MAAM,MAAM,OAAgB,OAAO,mBAAmB,GAAG;AAAA,QAC3D,QAAQ;AAAA,QACR,MAAM;AAAA,MAAA,CACT;AACD,UAAI,SAAS,UAAW,SAAQ,UAAU,GAAG;AAAA,IACjD,SAAS,OAAO;AACZ,UAAI,SAAS,QAAS,SAAQ,QAAQ,KAAK;AAC3C,YAAM;AAAA,IACV,UAAA;AACI,cAAQ,QAAQ;AAAA,IACpB;AAAA,EACJ;AAEA,SAAO;AAAA,IACH;AAAA,IACA;AAAA,EAAA;AAER;AAmBO,MAAM,mBAAmB,MAAM;AAClC,QAAM,SAAS,aAAA;AACf,QAAM,UAAU,IAAI,KAAK;AAEzB,QAAM,SAAS,OAAO,IAAY,YAAyE;AACvG,YAAQ,QAAQ;AAChB,QAAI;AACA,YAAM,OAAO,OAAO,YAAY,EAAE,EAAE,GAAG;AAAA,QACnC,QAAQ;AAAA,MAAA,CACX;AACD,UAAI,SAAS,UAAW,SAAQ,UAAA;AAAA,IACpC,SAAS,OAAO;AACZ,UAAI,SAAS,QAAS,SAAQ,QAAQ,KAAK;AAC3C,YAAM;AAAA,IACV,UAAA;AACI,cAAQ,QAAQ;AAAA,IACpB;AAAA,EACJ;AAEA,SAAO;AAAA,IACH;AAAA,IACA;AAAA,EAAA;AAER;"}