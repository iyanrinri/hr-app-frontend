import{_ as D}from"./Zw0ZmG7K.js";import{g as I,j as f,y as P,K as $,c as i,p as B,a as e,b as r,k as o,t as l,V as C,$ as q,F as S,l as L,w as N,o as d,a1 as U,d as M,Y as O,z,aq as Q,at as E,aE as F,v as V,ao as K}from"./DEyY0kFD.js";import{u as R}from"./CAATqtpM.js";import{u as Y,a as G,f as H}from"./DPFRp8Kn.js";import{_ as J}from"./CCY-pFV-.js";import{f as T}from"./DEBy37vB.js";import"./BV-bnHA6.js";import"./uRmCsCMF.js";import"./DYvQZ50l.js";import"./D8dPcGoU.js";const W={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4"},X={class:"bg-white rounded-lg shadow-xl w-full max-w-md"},Z={class:"p-6 border-b flex justify-between items-center"},ee={class:"p-6 space-y-4"},te={className:"font-medium text-gray-900"},se={class:"space-y-2"},ae=["value"],oe={key:0,class:"text-xs text-gray-500 bg-gray-50 p-3 rounded"},le={class:"flex justify-end gap-3 pt-4"},ne=I({__name:"AssignBalanceModal",props:{isOpen:{type:Boolean},employeeId:{},employeeName:{},leaveTypes:{}},emits:["close","assigned"],setup(h,{emit:c}){const y=h,x=c,p=f(""),u=f(0),w=f(!1);P(()=>p.value,m=>{const a=y.leaveTypes.find(g=>String(g.id)===m);a&&(u.value=a.defaultQuota)});const _=$(()=>y.leaveTypes.find(m=>String(m.id)===p.value)),v=async()=>{console.log("Assigning balance:",{employeeId:y.employeeId,leaveTypeConfigId:p.value,quota:u.value}),w.value=!0,setTimeout(()=>{w.value=!1,x("assigned"),x("close")},1e3)};return(m,a)=>{const g=J,A=D;return h.isOpen?(d(),i("div",W,[e("div",X,[e("div",Z,[a[4]||(a[4]=e("h3",{class:"text-lg font-bold"},"Assign Leave Balance",-1)),e("button",{onClick:a[0]||(a[0]=n=>m.$emit("close")),class:"text-gray-500 hover:text-gray-700"},[r(o(U),{class:"w-5 h-5 rotate-45"})])]),e("div",ee,[e("div",null,[a[5]||(a[5]=e("p",{class:"text-sm text-gray-600"},"Employee",-1)),e("p",te,l(h.employeeName),1)]),e("div",se,[a[7]||(a[7]=e("label",{class:"text-sm font-medium text-gray-700"},"Leave Type",-1)),C(e("select",{class:"flex h-10 w-full rounded-md border border-gray-300 bg-transparent px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-brand-navy","onUpdate:modelValue":a[1]||(a[1]=n=>p.value=n)},[a[6]||(a[6]=e("option",{value:""},"-- Select Leave Type --",-1)),(d(!0),i(S,null,L(h.leaveTypes,n=>(d(),i("option",{key:n.id,value:String(n.id)},l(n.name),9,ae))),128))],512),[[q,p.value]])]),r(g,{label:"Quota (Days)",type:"number",modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=n=>u.value=n),modelModifiers:{number:!0},placeholder:"Enter quota"},null,8,["modelValue"]),o(_)?(d(),i("div",oe," Default quota for "+l(o(_).name)+": "+l(o(_).defaultQuota)+" days ",1)):B("",!0),e("div",le,[r(A,{type:"button",variant:"ghost",onClick:a[3]||(a[3]=n=>m.$emit("close"))},{default:N(()=>[...a[8]||(a[8]=[M(" Cancel ",-1)])]),_:1}),r(A,{onClick:v,disabled:!p.value||u.value<=0||w.value},{default:N(()=>[...a[9]||(a[9]=[M(" Assign Balance ",-1)])]),_:1},8,["disabled"])])])])])):B("",!0)}}}),ie={class:"space-y-6 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},de={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},re={class:"flex items-center gap-3"},ue={class:"text-sm font-medium text-blue-900"},pe={class:"text-xs text-blue-700"},ce={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 space-y-4"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ye={class:"space-y-2"},xe={class:"relative"},ge={class:"space-y-2"},ve=["value"],fe={key:1,class:"text-center py-12 bg-white rounded-xl shadow-sm border border-dashed border-gray-300"},he={key:2,class:"space-y-6"},we={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},_e={class:"flex items-center justify-between"},be={class:"flex items-center gap-4"},ke={class:"h-12 w-12 rounded-full bg-brand-navy flex items-center justify-center text-white"},$e={class:"text-lg font-bold"},Ne={class:"text-lg font-semibold text-gray-900"},Ae={class:"text-sm text-gray-500"},Te={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},Me={key:0,class:"p-8 text-center"},Be={key:1,class:"p-8 text-center"},Ce={key:2,class:"overflow-x-auto"},Se={class:"min-w-full divide-y divide-gray-200"},Le={class:"bg-white divide-y divide-gray-200"},Qe={class:"px-6 py-4 whitespace-nowrap"},Ee={class:"flex items-center"},Ve={class:"text-sm font-medium text-gray-900"},De={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ie={class:"px-6 py-4 whitespace-nowrap"},qe={class:"flex items-center gap-2"},Ue={class:"text-sm text-gray-900"},je={class:"w-24 bg-gray-200 rounded-full h-2"},Pe={class:"px-6 py-4 whitespace-nowrap"},Oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ze={class:"px-6 py-4 whitespace-nowrap"},Fe={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},Ke={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},Re={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},at=I({__name:"index",setup(h){const c=f(""),y=f(""),x=f(!1),{data:p}=R(),{data:u}=Y(),w=$(()=>u.value?.id),{data:_}=G(w),{data:v,loading:m,refresh:a}=H(c),g=$(()=>v.value?Array.isArray(v.value)?v.value:v.value.data||[]:[]),A=$(()=>{if(!p.value)return[];const b=y.value.toLowerCase();return p.value.filter(t=>{const k=`${t.firstName} ${t.lastName}`.toLowerCase(),s=t.position?.toLowerCase()||"";return k.includes(b)||s.includes(b)})}),n=$(()=>p.value?.find(b=>String(b.id)===c.value)),j=()=>{a()};return(b,t)=>{const k=D;return d(),i("div",ie,[t[14]||(t[14]=e("div",{class:"md:flex md:items-center md:justify-between"},[e("div",{class:"flex-1 min-w-0"},[e("h2",{class:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"}," Leave Administration "),e("p",{class:"mt-1 text-sm text-gray-500"}," Manage employee leave balances and quotas ")])],-1)),o(u)?(d(),i("div",de,[e("div",re,[r(o(z),{class:"w-5 h-5 text-blue-600"}),e("div",null,[e("p",ue," Active Period: "+l(o(u).name),1),e("p",pe,l(o(T)(new Date(o(u).startDate),"MMM d, yyyy"))+" - "+l(o(T)(new Date(o(u).endDate),"MMM d, yyyy")),1)])])])):B("",!0),e("div",ce,[e("div",me,[e("div",ye,[t[5]||(t[5]=e("label",{class:"text-sm font-medium text-gray-700"},"Search Employee",-1)),e("div",xe,[r(o(Q),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),C(e("input",{type:"text",class:"flex h-10 w-full rounded-md border border-gray-300 bg-transparent pl-10 pr-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-brand-navy focus:ring-offset-2",placeholder:"Search by name or position...","onUpdate:modelValue":t[0]||(t[0]=s=>y.value=s)},null,512),[[O,y.value]])])]),e("div",ge,[t[7]||(t[7]=e("label",{class:"text-sm font-medium text-gray-700"},"Select Employee",-1)),C(e("select",{class:"flex h-10 w-full rounded-md border border-gray-300 bg-transparent px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-brand-navy focus:ring-offset-2","onUpdate:modelValue":t[1]||(t[1]=s=>c.value=s)},[t[6]||(t[6]=e("option",{value:""},"-- Select Employee --",-1)),(d(!0),i(S,null,L(A.value,s=>(d(),i("option",{key:s.id,value:String(s.id)},l(s.firstName)+" "+l(s.lastName)+" ("+l(s.position)+") ",9,ve))),128))],512),[[q,c.value]])])])]),c.value?(d(),i("div",he,[e("div",we,[e("div",_e,[e("div",be,[e("div",ke,[e("span",$e,l(n.value?.firstName.charAt(0))+l(n.value?.lastName.charAt(0)),1)]),e("div",null,[e("h3",Ne,l(n.value?.firstName)+" "+l(n.value?.lastName),1),e("p",Ae,l(n.value?.position),1)])]),r(k,{onClick:t[2]||(t[2]=s=>x.value=!0)},{default:N(()=>[r(o(U),{class:"w-4 h-4 mr-2"}),t[9]||(t[9]=M(" Assign Leave Balance ",-1))]),_:1})])]),e("div",Te,[t[13]||(t[13]=e("div",{class:"px-6 py-5 border-b border-gray-200 bg-gray-50"},[e("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"Leave Balances"),e("p",{class:"mt-1 text-sm text-gray-500"},"Current leave quotas and usage")],-1)),o(m)?(d(),i("div",Me,"Loading balances...")):!g.value||g.value.length===0?(d(),i("div",Be,[r(o(E),{class:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t[11]||(t[11]=e("p",{class:"text-gray-500"},"No leave balances assigned yet",-1)),r(k,{variant:"ghost",onClick:t[3]||(t[3]=s=>x.value=!0),class:"mt-4"},{default:N(()=>[...t[10]||(t[10]=[M(" Assign First Balance ",-1)])]),_:1})])):(d(),i("div",Ce,[e("table",Se,[t[12]||(t[12]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Leave Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total Quota"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Used"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Remaining"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Valid Period"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Le,[(d(!0),i(S,null,L(g.value,s=>(d(),i("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Qe,[e("div",Ee,[r(o(E),{class:"w-5 h-5 text-gray-400 mr-3"}),e("div",Ve,l(s.leaveTypeName),1)])]),e("td",De,l(s.totalQuota)+" days ",1),e("td",Ie,[e("div",qe,[e("span",Ue,l(s.usedQuota)+" days",1),e("div",je,[e("div",{class:V(`h-2 rounded-full ${s.usedQuota/s.totalQuota*100>=90?"bg-red-500":s.usedQuota/s.totalQuota*100>=70?"bg-yellow-500":"bg-green-500"}`),style:F({width:`${Math.min(s.usedQuota/s.totalQuota*100,100)}%`})},null,6)])])]),e("td",Pe,[e("span",{class:V(`text-sm font-medium ${s.remainingQuota<=0?"text-red-600":s.remainingQuota<=3?"text-yellow-600":"text-green-600"}`)},l(s.remainingQuota)+" days ",3)]),e("td",Oe,l(o(T)(new Date(s.validFrom),"MMM d, yy"))+" - "+l(o(T)(new Date(s.validTo),"MMM d, yy")),1),e("td",ze,[s.isActive?(d(),i("span",Fe,"Active")):(d(),i("span",Ke,"Inactive"))]),e("td",Re,[r(k,{variant:"ghost",class:"h-8 px-2"},{default:N(()=>[r(o(K),{class:"w-4 h-4"})]),_:1})])]))),128))])])]))])])):(d(),i("div",fe,[r(o(Q),{class:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t[8]||(t[8]=e("p",{class:"text-gray-500 text-lg"},"Select an employee to view their leave balances",-1))])),r(ne,{isOpen:x.value,employeeId:c.value,employeeName:n.value?`${n.value.firstName} ${n.value.lastName}`:"",leaveTypes:o(_)||[],onClose:t[4]||(t[4]=s=>x.value=!1),onAssigned:j},null,8,["isOpen","employeeId","employeeName","leaveTypes"])])}}});export{at as default};
