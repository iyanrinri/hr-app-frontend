import{_ as T}from"./CrVLMR1u.js";import{_ as R}from"./v2qKE77T.js";import{_ as j,a as F}from"./DHooiG8A.js";import{_ as V,a as H}from"./C2WlNZHx.js";import{d as I}from"./SxwX5CpG.js";import{u as O}from"./D7ynCt_9.js";import{g as U,j as X,v as q,c as d,D as M,o as r,b as s,a as t,k as e,V as k,W,w as i,d as m,y as Y,X as E,t as a,E as N,I as z,Y as Z,s as G,P as C,S as D,Z as J,F as S,l as P,p as K}from"./CgE31YDV.js";import"./Dtjc6EhN.js";import"./BJ2ClxiI.js";const Q={key:0,class:"flex items-center gap-2 text-sm text-green-600"},tt={key:1,class:"flex items-center gap-2 text-sm text-red-600"},et=U({__name:"NotificationPermissionButton",setup(L){const _=X("default");q(()=>{"Notification"in window&&(_.value=Notification.permission)});const f=async()=>{if("Notification"in window){const x=await Notification.requestPermission();_.value=x,x==="granted"&&new Notification("Notifications Enabled! ðŸŽ‰",{body:"You will now receive attendance updates",icon:"/favicon.ico"})}};return(x,n)=>{const y=T;return _.value==="granted"?(r(),d("div",Q,[s(e(k),{class:"w-4 h-4"}),n[0]||(n[0]=t("span",null,"Notifications enabled",-1))])):_.value==="denied"?(r(),d("div",tt,[s(e(W),{class:"w-4 h-4"}),n[1]||(n[1]=t("span",null,"Notifications blocked",-1))])):(r(),M(y,{key:2,onClick:f,variant:"secondary",class:"text-sm"},{default:i(()=>[s(e(k),{class:"w-4 h-4 mr-2"}),n[2]||(n[2]=m(" Enable Notifications ",-1))]),_:1}))}}}),st={class:"space-y-6"},at={key:0,class:"flex flex-col items-center justify-center py-12"},nt={key:1,class:"text-center py-12 text-gray-500"},ot={key:2,class:"space-y-6"},it={class:"flex justify-between items-center"},lt={class:"flex items-center gap-4 mt-2"},rt={class:"flex items-center text-sm text-gray-600"},dt={class:"flex items-center text-sm"},ct={class:"flex gap-2"},xt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},pt={class:"flex items-center justify-between"},ut={class:"text-3xl font-bold text-gray-900"},mt={class:"flex items-center justify-between"},_t={class:"text-3xl font-bold text-green-600"},ft={class:"text-xs text-gray-500 mt-1"},yt={class:"flex items-center justify-between"},gt={class:"text-3xl font-bold text-red-600"},ht={class:"flex items-center justify-between"},wt={class:"text-3xl font-bold text-yellow-600"},bt={class:"text-xs text-gray-500 mt-1"},vt={class:"flex items-center justify-between"},kt={class:"text-lg font-bold text-gray-900"},Et={class:"text-right"},Nt={class:"text-lg font-bold text-gray-900"},Ct={class:"text-xs text-gray-500 mt-1"},Dt={key:0,class:"overflow-x-auto"},St={class:"min-w-full divide-y divide-gray-200"},Pt={class:"bg-white divide-y divide-gray-200"},Tt={class:"px-6 py-4 whitespace-nowrap"},Ut={class:"text-sm font-medium text-gray-900"},Lt={class:"text-sm text-gray-500"},At={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Bt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},$t={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Rt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},jt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ft={class:"px-6 py-4 whitespace-nowrap"},Vt={class:"flex flex-col gap-1"},Ht={key:0,class:"text-xs text-yellow-600"},It={key:1,class:"text-center text-gray-500 py-4"},Ot={key:0,class:"overflow-x-auto"},Xt={class:"min-w-full divide-y divide-gray-200"},qt={class:"bg-white divide-y divide-gray-200"},Mt={class:"px-6 py-4 whitespace-nowrap"},Wt={class:"text-sm font-medium text-gray-900"},Yt={class:"text-sm text-gray-500"},zt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Zt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Gt={key:1,class:"text-center text-gray-500 py-4"},ie=U({__name:"index",setup(L){const f=Y().params.tenant_slug,x=O(),{data:n,loading:y,refresh:g}=I();E(()=>x.dashboardUpdateTrigger,c=>{c>0&&(console.log("ðŸ”„ [AUTO-REFRESH] Dashboard refreshing due to dashboard-update event"),g())}),E(()=>x.notifications,c=>{c.length>0&&g()},{deep:!0});const h=c=>{if(!c)return"-";try{return new Date(c).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return"-"}},A=c=>({PRESENT:"bg-green-100 text-green-800",LATE:"bg-yellow-100 text-yellow-800",ABSENT:"bg-red-100 text-red-800",EXCUSED:"bg-blue-100 text-blue-800"})[c||""]||"bg-gray-100 text-gray-800",B=c=>new Date(c).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return(c,o)=>{const w=T,$=R,p=F,u=j,b=H,v=V;return r(),d("div",st,[e(y)&&!e(n)?(r(),d("div",at,[...o[0]||(o[0]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-navy mb-4"},null,-1),t("p",{class:"text-gray-600"},"Loading today's attendance...",-1)])])):e(n)?(r(),d("div",ot,[t("div",it,[t("div",null,[o[1]||(o[1]=t("h2",{class:"text-2xl font-bold text-gray-900"},"Today's Attendance Dashboard",-1)),t("div",lt,[t("div",rt,[s(e(z),{class:"w-4 h-4 mr-2"}),m(" "+a(B(e(n).date)),1)]),t("div",dt,[t("div",{class:N(["w-2 h-2 rounded-full mr-2",e(x).isConnected?"bg-green-500":"bg-red-500"])},null,2),m(" "+a(e(x).isConnected?"Live Updates Active":"Disconnected"),1)]),s(et)])]),t("div",ct,[s(w,{onClick:e(g),variant:"secondary"},{default:i(()=>[s(e(Z),{class:"w-4 h-4 mr-2"}),o[2]||(o[2]=m(" Refresh ",-1))]),_:1},8,["onClick"]),s($,{to:e(f)?`/${e(f)}/dashboard/attendance/history`:"/dashboard/attendance/history"},{default:i(()=>[s(w,{variant:"secondary"},{default:i(()=>[...o[3]||(o[3]=[m("View History",-1)])]),_:1})]),_:1},8,["to"])])]),t("div",xt,[s(u,null,{default:i(()=>[s(p,{class:"pt-6"},{default:i(()=>[t("div",pt,[t("div",null,[o[4]||(o[4]=t("p",{class:"text-sm text-gray-600 mb-1"},"Total Employees",-1)),t("p",ut,a(e(n).summary.totalEmployees),1)]),s(e(G),{class:"w-10 h-10 text-gray-400"})])]),_:1})]),_:1}),s(u,null,{default:i(()=>[s(p,{class:"pt-6"},{default:i(()=>[t("div",mt,[t("div",null,[o[5]||(o[5]=t("p",{class:"text-sm text-gray-600 mb-1"},"Present",-1)),t("p",_t,a(e(n).summary.totalPresent),1),t("p",ft,a(e(n).summary.attendanceRate.toFixed(0))+"% rate",1)]),s(e(C),{class:"w-10 h-10 text-green-400"})])]),_:1})]),_:1}),s(u,null,{default:i(()=>[s(p,{class:"pt-6"},{default:i(()=>[t("div",yt,[t("div",null,[o[6]||(o[6]=t("p",{class:"text-sm text-gray-600 mb-1"},"Absent",-1)),t("p",gt,a(e(n).summary.totalAbsent),1)]),s(e(D),{class:"w-10 h-10 text-red-400"})])]),_:1})]),_:1}),s(u,null,{default:i(()=>[s(p,{class:"pt-6"},{default:i(()=>[t("div",ht,[t("div",null,[o[7]||(o[7]=t("p",{class:"text-sm text-gray-600 mb-1"},"Late",-1)),t("p",wt,a(e(n).summary.totalLate),1),t("p",bt,a(e(n).summary.lateRate.toFixed(0))+"% rate",1)]),s(e(J),{class:"w-10 h-10 text-yellow-400"})])]),_:1})]),_:1})]),s(u,null,{default:i(()=>[s(p,{class:"pt-6"},{default:i(()=>[t("div",vt,[t("div",null,[o[8]||(o[8]=t("p",{class:"text-sm text-gray-600"},"Attendance Period",-1)),t("p",kt,a(e(n).attendancePeriod.name),1)]),t("div",Et,[o[9]||(o[9]=t("p",{class:"text-sm text-gray-600"},"Working Hours",-1)),t("p",Nt,a(e(n).attendancePeriod.workingStartTime)+" - "+a(e(n).attendancePeriod.workingEndTime),1),t("p",Ct," Tolerance: "+a(e(n).attendancePeriod.toleranceMinutes)+" minutes ",1)])])]),_:1})]),_:1}),s(u,null,{default:i(()=>[s(v,null,{default:i(()=>[s(b,{class:"flex items-center"},{default:i(()=>[s(e(C),{class:"w-5 h-5 mr-2 text-green-600"}),m(" Present Employees ("+a(e(n).presentEmployees.length)+") ",1)]),_:1})]),_:1}),s(p,null,{default:i(()=>[e(n).presentEmployees.length>0?(r(),d("div",Dt,[t("table",St,[o[10]||(o[10]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Employee"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Department"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Position"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Check In"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Check Out"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Duration"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Status")])],-1)),t("tbody",Pt,[(r(!0),d(S,null,P(e(n).presentEmployees,l=>(r(),d("tr",{key:l.id,class:"hover:bg-gray-50"},[t("td",Tt,[t("div",null,[t("p",Ut,a(l.firstName)+" "+a(l.lastName),1),t("p",Lt,a(l.email),1)])]),t("td",At,a(l.department),1),t("td",Bt,a(l.position),1),t("td",$t,a(h(l.checkIn)),1),t("td",Rt,a(h(l.checkOut)),1),t("td",jt,a(l.workDuration?`${(l.workDuration/60).toFixed(1)}h`:"-"),1),t("td",Ft,[t("div",Vt,[t("span",{class:N(["inline-flex items-center px-3 py-1 rounded-full text-xs font-medium",A(l.status)])},a(l.status),3),l.isLate?(r(),d("span",Ht," Late by "+a(l.minutesLate)+" min ",1)):K("",!0)])])]))),128))])])])):(r(),d("p",It,"No employees present yet"))]),_:1})]),_:1}),s(u,null,{default:i(()=>[s(v,null,{default:i(()=>[s(b,{class:"flex items-center"},{default:i(()=>[s(e(D),{class:"w-5 h-5 mr-2 text-red-600"}),m(" Absent Employees ("+a(e(n).absentEmployees.length)+") ",1)]),_:1})]),_:1}),s(p,null,{default:i(()=>[e(n).absentEmployees.length>0?(r(),d("div",Ot,[t("table",Xt,[o[11]||(o[11]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Employee"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Department"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Position")])],-1)),t("tbody",qt,[(r(!0),d(S,null,P(e(n).absentEmployees,l=>(r(),d("tr",{key:l.id,class:"hover:bg-gray-50"},[t("td",Mt,[t("div",null,[t("p",Wt,a(l.firstName)+" "+a(l.lastName),1),t("p",Yt,a(l.email),1)])]),t("td",zt,a(l.department),1),t("td",Zt,a(l.position),1)]))),128))])])])):(r(),d("p",Gt,"All employees are present! ðŸŽ‰"))]),_:1})]),_:1})])):(r(),d("div",nt," No attendance data available for today "))])}}});export{ie as default};
