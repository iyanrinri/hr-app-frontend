import{_ as q}from"./BfigT44c.js";import{_ as J}from"./B9YZYzJt.js";import{_ as Q}from"./Dnm_KAh1.js";import{_ as Z}from"./D2JNKblU.js";import{g as P,j as b,af as tt,ak as et,c as l,o as r,t as d,x as st,aw as ot,K as at,a as t,I as nt,p as L,b as o,d as n,k as s,w as f,v as w,V as rt,Y as lt,z as U,ax as N,ay as O,az as V,aA as k,aB as it,aC as dt,aD as ct}from"./DX_cbf2s.js";import{u as mt,a as ut,b as xt,c as gt}from"./D7V6xLk_.js";import{_ as pt}from"./B8QOIkXi.js";import{s as ft}from"./D-UBt9DX.js";import{e as yt}from"./Cwxqfid7.js";import{f as C}from"./DEBy37vB.js";import"./uRmCsCMF.js";import"./H1PkYqcn.js";import"./czVTDFG8.js";import"./crM-xtPk.js";const bt=globalThis.setInterval,vt={class:"font-mono text-3xl md:text-4xl font-bold tracking-wider text-brand-navy"},_t={key:0},ht={key:1},wt=P({__name:"DigitalClock",setup($){const g=b(null);let m=null;return tt(()=>{g.value=new Date,m=bt(()=>{g.value=new Date},1e3)}),et(()=>{m&&clearInterval(m)}),(T,y)=>(r(),l("div",vt,[g.value?(r(),l("span",_t,d(g.value.toLocaleTimeString("en-US",{hour12:!1})),1)):(r(),l("span",ht,"--:--:--"))]))}}),kt={class:"space-y-8 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Ct={class:"flex flex-col md:flex-row md:justify-between md:items-end gap-4 border-b border-gray-100 pb-6"},Tt={class:"flex items-center text-gray-500 mt-1"},Dt={class:"flex flex-col items-end"},Et={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},St={class:"lg:col-span-2 space-y-6"},It={class:"bg-white rounded-2xl shadow-xl shadow-brand-navy/5 overflow-hidden border border-gray-100"},At={class:"p-8"},Mt={class:"flex justify-between items-start mb-8"},Lt={class:"flex items-center gap-2 mb-2"},Ut={key:0,class:"h-8 w-32 bg-gray-100 rounded animate-pulse mt-2"},Nt={key:0,class:"text-right"},Ot={class:"flex items-center justify-end gap-2 mb-2"},Vt={class:"text-3xl font-bold text-brand-navy"},Pt={class:"grid grid-cols-2 gap-8 mb-8"},$t={class:"flex items-center text-gray-400 mb-2"},Bt={class:"text-2xl font-mono text-gray-900"},Rt={class:"flex items-center text-gray-400 mb-2"},jt={class:"text-2xl font-mono text-gray-900"},zt={class:"mb-6"},Ht={class:"grid grid-cols-2 gap-4"},Ft={key:0,class:"flex items-center"},Gt={key:1,class:"flex items-center"},Wt={key:0,class:"flex items-center"},Xt={key:1,class:"flex items-center"},Yt={class:"mt-4 flex items-center justify-center text-xs text-gray-400"},Kt={class:"space-y-6"},qt={class:"flex items-center justify-between"},Jt={class:"grid grid-cols-1 gap-4"},Qt={class:"p-5 rounded-xl bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-100 relative overflow-hidden"},Zt={class:"absolute right-0 top-0 p-3 opacity-10"},te={class:"text-3xl font-bold text-emerald-700 mt-1"},ee={class:"p-5 rounded-xl bg-gradient-to-br from-amber-50 to-yellow-50 border border-amber-100 relative overflow-hidden"},se={class:"absolute right-0 top-0 p-3 opacity-10"},oe={class:"text-3xl font-bold text-amber-700 mt-1"},ae={class:"p-5 rounded-xl bg-gradient-to-br from-rose-50 to-red-50 border border-rose-100 relative overflow-hidden"},ne={class:"absolute right-0 top-0 p-3 opacity-10"},re={class:"text-3xl font-bold text-rose-700 mt-1"},le={class:"p-5 rounded-xl bg-gradient-to-br from-indigo-50 to-violet-50 border border-indigo-100 relative overflow-hidden"},ie={class:"absolute right-0 top-0 p-3 opacity-10"},de={class:"text-3xl font-bold text-indigo-700 mt-1"},Ce=P({__name:"index",setup($){const m=st().params.tenant_slug,T=ot(),y=at(()=>T.user),v=b(""),u=b(""),c=b(!1),{data:i,loading:_,refresh:D}=mt(),{mutate:B,loading:R}=ut(),{mutate:j,loading:z}=xt(),E=new Date,H=C(ft(E),"yyyy-MM-dd"),F=C(yt(E),"yyyy-MM-dd"),{data:p,refresh:S}=gt(H,F,v),I=()=>new Promise((a,e)=>{if(!navigator.geolocation){e(new Error("Geolocation is not supported by your browser"));return}c.value=!0,navigator.geolocation.getCurrentPosition(x=>{c.value=!1,a({latitude:x.coords.latitude,longitude:x.coords.longitude})},x=>{c.value=!1,e(x)})}),G=async()=>{try{const a=await I();await B({...a,notes:u.value||void 0}),u.value="",D(),S()}catch(a){alert("Please enable location access to clock in"),console.error(a)}},W=async()=>{try{const a=await I();await j({...a,notes:u.value||void 0}),u.value="",D(),S()}catch(a){alert("Please enable location access to clock out"),console.error(a)}},A=a=>a?new Date(a).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}):"--:--",X=a=>({PRESENT:"text-green-600 bg-green-50 ring-green-500/20",LATE:"text-yellow-600 bg-yellow-50 ring-yellow-500/20",ABSENT:"text-red-600 bg-red-50 ring-red-500/20",EXCUSED:"text-blue-600 bg-blue-50 ring-blue-500/20"})[a||""]||"text-gray-600 bg-gray-50 ring-gray-500/20";return(a,e)=>{const x=q,Y=J,M=Q,K=Z;return r(),l("div",kt,[t("div",Ct,[t("div",null,[e[2]||(e[2]=t("h2",{class:"text-2xl font-bold text-gray-900"},"My Attendance",-1)),t("p",Tt,[o(s(U),{class:"w-4 h-4 mr-2"}),n(" "+d(s(C)(new Date,"EEEE, d MMMM yyyy")),1)])]),t("div",Dt,[e[3]||(e[3]=t("div",{class:"text-xs text-gray-400 uppercase font-medium mb-1"},"Current Time",-1)),o(wt)])]),y.value?.role==="HR"||y.value?.role==="SUPER"||y.value?.role==="ADMIN"?(r(),nt(Y,{key:0,class:"border-none shadow-sm bg-gray-50"},{default:f(()=>[o(x,{class:"pt-6"},{default:f(()=>[o(pt,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=h=>v.value=h)},null,8,["modelValue"])]),_:1})]),_:1})):L("",!0),t("div",Et,[t("div",St,[t("div",It,[t("div",At,[t("div",Mt,[t("div",null,[t("div",Lt,[o(s(U),{class:"w-5 h-5 text-gray-400"}),e[4]||(e[4]=t("h3",{class:"text-lg font-medium text-gray-500"},"Today's Status",-1))]),s(_)?(r(),l("div",Ut)):(r(),l("div",{key:1,class:w(["inline-flex items-center px-4 py-1.5 rounded-full text-sm font-bold mt-2 ring-1 ring-inset",X(s(i)?.status)])},d(s(i)?.status||"NOT STARTED"),3))]),s(i)?.workDuration?(r(),l("div",Nt,[t("div",Ot,[o(s(N),{class:"w-5 h-5 text-gray-400"}),e[5]||(e[5]=t("p",{class:"text-sm text-gray-500"},"Duration",-1))]),t("p",Vt,[n(d((s(i).workDuration/60).toFixed(1)),1),e[6]||(e[6]=t("span",{class:"text-sm font-normal text-gray-400 ml-1"},"hrs",-1))])])):L("",!0)]),t("div",Pt,[t("div",null,[t("div",$t,[o(s(O),{class:"w-4 h-4 mr-2"}),e[7]||(e[7]=t("span",{class:"text-xs font-medium uppercase tracking-wider"},"Clock In",-1))]),t("div",Bt,d(s(_)?"...":A(s(i)?.checkIn)),1)]),t("div",null,[t("div",Rt,[o(s(V),{class:"w-4 h-4 mr-2"}),e[8]||(e[8]=t("span",{class:"text-xs font-medium uppercase tracking-wider"},"Clock Out",-1))]),t("div",jt,d(s(_)?"...":A(s(i)?.checkOut)),1)])]),t("div",zt,[rt(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=h=>u.value=h),placeholder:"Add notes for your attendance (optional)...",class:"w-full bg-gray-50 border-0 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-brand-navy/20 resize-none transition-all placeholder:text-gray-400 outline-none",rows:"2"},null,512),[[lt,u.value]])]),t("div",Ht,[o(M,{onClick:G,disabled:s(R)||c.value||!!s(i)?.checkIn,class:w(["h-14 text-lg font-bold shadow-lg shadow-blue-500/20 bg-gradient-to-r from-blue-600 to-cyan-500 hover:from-blue-700 hover:to-cyan-600 border-0 text-white",s(i)?.checkIn?"opacity-50 grayscale":""])},{default:f(()=>[c.value?(r(),l("span",Ft,[o(s(k),{class:"w-5 h-5 mr-2 animate-pulse"}),e[9]||(e[9]=n(" Locating... ",-1))])):(r(),l("span",Gt,[o(s(O),{class:"w-5 h-5 mr-2"}),e[10]||(e[10]=n(" Clock In ",-1))]))]),_:1},8,["disabled","class"]),o(M,{onClick:W,disabled:s(z)||c.value||!s(i)?.checkIn,class:w(["h-14 text-lg font-bold shadow-lg shadow-orange-500/20 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white border-0",s(i)?.checkIn?"":"opacity-50 grayscale"])},{default:f(()=>[c.value?(r(),l("span",Wt,[o(s(k),{class:"w-5 h-5 mr-2 animate-pulse"}),e[11]||(e[11]=n(" Locating... ",-1))])):(r(),l("span",Xt,[o(s(V),{class:"w-5 h-5 mr-2"}),e[12]||(e[12]=n(" Clock Out ",-1))]))]),_:1},8,["disabled","class"])]),t("div",Yt,[o(s(k),{class:"w-3 h-3 mr-1"}),e[13]||(e[13]=n(" Your location is recorded securely ",-1))])])])]),t("div",Kt,[t("div",qt,[e[15]||(e[15]=t("h3",{class:"font-bold text-gray-900"},"Month Summary",-1)),o(K,{to:s(m)?`/${s(m)}/dashboard/attendance/history`:"/dashboard/attendance/history",class:"text-xs font-medium text-brand-navy hover:underline"},{default:f(()=>[...e[14]||(e[14]=[n(" View History ",-1)])]),_:1},8,["to"])]),t("div",Jt,[t("div",Qt,[t("div",Zt,[o(s(it),{class:"w-16 h-16 text-emerald-600"})]),e[17]||(e[17]=t("p",{class:"text-emerald-600 font-medium text-sm"},"Present",-1)),t("p",te,[n(d(s(p)?.statusCounts?.PRESENT||0),1),e[16]||(e[16]=t("span",{class:"text-sm font-normal text-emerald-600/60 ml-1"},"days",-1))])]),t("div",ee,[t("div",se,[o(s(dt),{class:"w-16 h-16 text-amber-600"})]),e[19]||(e[19]=t("p",{class:"text-amber-600 font-medium text-sm"},"Late",-1)),t("p",oe,[n(d(s(p)?.statusCounts?.LATE||0),1),e[18]||(e[18]=t("span",{class:"text-sm font-normal text-amber-600/60 ml-1"},"days",-1))])]),t("div",ae,[t("div",ne,[o(s(ct),{class:"w-16 h-16 text-rose-600"})]),e[21]||(e[21]=t("p",{class:"text-rose-600 font-medium text-sm"},"Absent",-1)),t("p",re,[n(d(s(p)?.statusCounts?.ABSENT||0),1),e[20]||(e[20]=t("span",{class:"text-sm font-normal text-rose-600/60 ml-1"},"days",-1))])]),t("div",le,[t("div",ie,[o(s(N),{class:"w-16 h-16 text-indigo-600"})]),e[23]||(e[23]=t("p",{class:"text-indigo-600 font-medium text-sm"},"Avg Hours/Day",-1)),t("p",de,[n(d(s(p)?.averageWorkDuration?(s(p).averageWorkDuration/60).toFixed(1):"0.0")+" ",1),e[22]||(e[22]=t("span",{class:"text-sm font-normal text-indigo-600/60 ml-1"},"hrs",-1))])])])])])])}}});export{Ce as default};
