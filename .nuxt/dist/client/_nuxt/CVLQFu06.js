import{_ as B}from"./Zw0ZmG7K.js";import{u as F,a as J,b as Q,c as W,d as K,e as Z}from"./DPFRp8Kn.js";import{_ as q}from"./CCY-pFV-.js";import{g as z,K as T,j as I,c as f,o as m,n as ee,k as a,F as E,a as e,p as N,b as c,V as S,$ as te,l as A,t as v,Y as L,w,d as D,a1 as se,at as X,v as ae,z as oe,au as ne,C as j,P as re,Z as le,av as ie,I as de,X as ue}from"./DEyY0kFD.js";import{t as V,c as ce,n as $,g as me,e as fe,a as G,m as H,b as R,f as U}from"./DEBy37vB.js";import{e as pe}from"./Cwxqfid7.js";import{d as ye,g as xe}from"./cyg0TJd-.js";import{Y as ve,h as Y,G as ge,V as be,S as he}from"./EVn079z-.js";import"./BV-bnHA6.js";import"./uRmCsCMF.js";import"./DYvQZ50l.js";import"./D8dPcGoU.js";function P(l,i){const d=+V(l)-+V(i);return d<0?-1:d>0?1:d}function we(l){return ce(l,Date.now())}function De(l,i,d){const[g,o]=$(d?.in,l,i),b=g.getFullYear()-o.getFullYear(),h=g.getMonth()-o.getMonth();return b*12+h}function _e(l,i){const d=V(l,i?.in);return d.setHours(23,59,59,999),d}function Me(l,i){const d=V(l,i?.in);return+_e(d,i)==+pe(d,i)}function Ce(l,i,d){const[g,o,b]=$(d?.in,l,l,i),h=P(o,b),n=Math.abs(De(o,b));if(n<1)return 0;o.getMonth()===1&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-h*n);let r=P(o,b)===-h;Me(g)&&n===1&&P(g,b)===1&&(r=!1);const p=h*(n-+r);return p===0?0:p}function ke(l,i,d){const g=ye(l,i)/1e3;return xe(d?.roundingMethod)(g)}function Ee(l,i,d){const g=me(),o=d?.locale??g.locale??fe,b=2520,h=P(l,i);if(isNaN(h))throw new RangeError("Invalid time value");const n=Object.assign({},d,{addSuffix:d?.addSuffix,comparison:h}),[r,p]=$(d?.in,...h>0?[i,l]:[l,i]),_=ke(p,r),M=(G(p)-G(r))/1e3,u=Math.round((_-M)/60);let s;if(u<2)return d?.includeSeconds?_<5?o.formatDistance("lessThanXSeconds",5,n):_<10?o.formatDistance("lessThanXSeconds",10,n):_<20?o.formatDistance("lessThanXSeconds",20,n):_<40?o.formatDistance("halfAMinute",0,n):_<60?o.formatDistance("lessThanXMinutes",1,n):o.formatDistance("xMinutes",1,n):u===0?o.formatDistance("lessThanXMinutes",1,n):o.formatDistance("xMinutes",u,n);if(u<45)return o.formatDistance("xMinutes",u,n);if(u<90)return o.formatDistance("aboutXHours",1,n);if(u<H){const y=Math.round(u/60);return o.formatDistance("aboutXHours",y,n)}else{if(u<b)return o.formatDistance("xDays",1,n);if(u<R){const y=Math.round(u/H);return o.formatDistance("xDays",y,n)}else if(u<R*2)return s=Math.round(u/R),o.formatDistance("aboutXMonths",s,n)}if(s=Ce(p,r),s<12){const y=Math.round(u/R);return o.formatDistance("xMonths",y,n)}else{const y=s%12,t=Math.trunc(s/12);return y<3?o.formatDistance("aboutXYears",t,n):y<9?o.formatDistance("overXYears",t,n):o.formatDistance("almostXYears",t+1,n)}}function Ne(l,i){return Ee(l,we(l),i)}var k=(l=>(l.PENDING="PENDING",l.MANAGER_APPROVED="MANAGER_APPROVED",l.HR_APPROVED="HR_APPROVED",l.APPROVED="APPROVED",l.REJECTED="REJECTED",l.CANCELLED="CANCELLED",l))(k||{});const Ae={key:0,class:"p-4 bg-yellow-50 text-yellow-800 rounded-md"},Re={class:"space-y-2"},Te=["value"],Pe={key:0,class:"text-xs text-red-500"},Ve={key:1,class:"text-xs text-gray-500 mt-1"},Se={class:"grid grid-cols-2 gap-4"},Ie={key:0,class:"text-sm text-brand-navy font-medium"},$e={class:"space-y-1"},Oe={key:0,class:"text-xs text-red-500"},Le={class:"space-y-1"},Xe={class:"flex justify-end gap-3 pt-4"},je=z({__name:"LeaveRequestForm",emits:["success","cancel"],setup(l,{emit:i}){const d=i,{data:g}=F(),o=T(()=>g.value?.id),{data:b}=J(o),{mutate:h,loading:n}=Q(),r=I({leaveTypeConfigId:"",startDate:"",endDate:"",reason:"",emergencyContact:"",handoverNotes:""}),p=I({}),_=()=>(p.value={},r.value.leaveTypeConfigId||(p.value.leaveTypeConfigId="Please select a leave type"),r.value.startDate||(p.value.startDate="Start date is required"),r.value.endDate||(p.value.endDate="End date is required"),(!r.value.reason||r.value.reason.length<3)&&(p.value.reason="Reason is required"),Object.keys(p.value).length===0),M=T(()=>b.value?.find(y=>String(y.id)===String(r.value.leaveTypeConfigId))),u=T(()=>{if(r.value.startDate&&r.value.endDate){const y=new Date(r.value.startDate),t=new Date(r.value.endDate);if(!isNaN(y.getTime())&&!isNaN(t.getTime())&&t>=y){const C=Math.abs(t.getTime()-y.getTime());return Math.ceil(C/(1e3*60*60*24))+1}}return 0}),s=async()=>{if(_())try{await h(r.value),d("success")}catch{}};return(y,t)=>{const C=q,O=B;return m(),f("form",{onSubmit:ee(s,["prevent"]),class:"space-y-4"},[a(g)?(m(),f(E,{key:1},[e("div",Re,[t[8]||(t[8]=e("label",{class:"text-sm font-medium text-gray-700"},"Leave Type",-1)),S(e("select",{"onUpdate:modelValue":t[0]||(t[0]=x=>r.value.leaveTypeConfigId=x),class:"flex h-10 w-full rounded-md border border-gray-300 bg-transparent px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-brand-navy focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[t[7]||(t[7]=e("option",{value:""},"Select Leave Type",-1)),(m(!0),f(E,null,A(a(b)?.filter(x=>x.isActive),x=>(m(),f("option",{key:x.id,value:String(x.id)},v(x.name),9,Te))),128))],512),[[te,r.value.leaveTypeConfigId]]),p.value.leaveTypeConfigId?(m(),f("p",Pe,v(p.value.leaveTypeConfigId),1)):N("",!0),M.value?(m(),f("div",Ve," Max "+v(M.value.maxConsecutiveDays)+" consecutive days. Notice: "+v(M.value.advanceNoticeDays)+" days. ",1)):N("",!0)]),e("div",Se,[c(C,{label:"Start Date",type:"date",modelValue:r.value.startDate,"onUpdate:modelValue":t[1]||(t[1]=x=>r.value.startDate=x),error:p.value.startDate},null,8,["modelValue","error"]),c(C,{label:"End Date",type:"date",modelValue:r.value.endDate,"onUpdate:modelValue":t[2]||(t[2]=x=>r.value.endDate=x),error:p.value.endDate},null,8,["modelValue","error"])]),u.value>0?(m(),f("div",Ie,"Estimated Duration: "+v(u.value)+" Days",1)):N("",!0),e("div",$e,[t[9]||(t[9]=e("label",{class:"text-sm font-medium text-gray-700"},"Reason",-1)),S(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=x=>r.value.reason=x),class:"w-full min-h-[80px] border border-gray-300 rounded-md p-2 focus:ring-brand-navy focus:border-brand-navy",placeholder:"Why are you taking leave?"},null,512),[[L,r.value.reason]]),p.value.reason?(m(),f("p",Oe,v(p.value.reason),1)):N("",!0)]),c(C,{label:"Emergency Contact",modelValue:r.value.emergencyContact,"onUpdate:modelValue":t[4]||(t[4]=x=>r.value.emergencyContact=x),placeholder:"+62...",error:p.value.emergencyContact},null,8,["modelValue","error"]),e("div",Le,[t[10]||(t[10]=e("label",{class:"text-sm font-medium text-gray-700"},"Handover Notes (Optional)",-1)),S(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=x=>r.value.handoverNotes=x),class:"w-full min-h-[60px] border border-gray-300 rounded-md p-2 focus:ring-brand-navy focus:border-brand-navy",placeholder:"Who will cover your tasks?"},null,512),[[L,r.value.handoverNotes]])]),e("div",Xe,[c(O,{type:"button",variant:"ghost",onClick:t[6]||(t[6]=x=>y.$emit("cancel"))},{default:w(()=>[...t[11]||(t[11]=[D("Cancel",-1)])]),_:1}),c(O,{type:"submit",disabled:a(n)||!a(g)},{default:w(()=>[...t[12]||(t[12]=[D("Submit Request",-1)])]),_:1},8,["disabled"])])],64)):(m(),f("div",Ae," No active leave period found. Please contact HR. "))],32)}}}),Ge={class:"space-y-8 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},He={class:"md:flex md:items-center md:justify-between"},Ue={class:"mt-4 flex md:mt-0 md:ml-4"},Ye={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Be={key:1,class:"col-span-full bg-white rounded-xl shadow-sm p-8 text-center border border-dashed border-gray-300"},ze={class:"px-6 py-6 text-white relative z-10"},Fe={class:"flex justify-between items-start"},Je={class:"text-2xl font-bold tracking-tight"},Qe={class:"bg-white/20 p-2 rounded-lg backdrop-blur-sm"},We={class:"mt-8 flex items-end justify-between"},Ke={class:"text-4xl font-extrabold mt-1"},Ze={class:"text-right"},qe={class:"text-white/80 text-xs mb-1"},et={class:"text-white/80 text-xs"},tt={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},st={class:"overflow-x-auto"},at={class:"min-w-full divide-y divide-gray-200"},ot={class:"bg-white divide-y divide-gray-200"},nt={key:1},rt={colspan:"5",class:"px-6 py-12 text-center text-gray-500"},lt={class:"flex flex-col items-center justify-center"},it={class:"px-6 py-4"},dt={class:"flex items-center"},ut={class:"text-sm font-medium text-gray-900"},ct={class:"text-sm text-gray-500 max-w-xs truncate"},mt={class:"px-6 py-4 whitespace-nowrap"},ft={class:"text-sm text-gray-900"},pt={class:"text-xs text-gray-500 mt-0.5"},yt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},xt={class:"px-6 py-4 whitespace-nowrap"},vt={key:0,class:"flex flex-col gap-1"},gt={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 border border-green-200"},bt={key:1,class:"flex flex-col gap-1"},ht={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 border border-blue-200"},wt={key:2,class:"flex flex-col gap-1"},Dt={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 border border-yellow-200"},_t={key:3,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 border border-red-200"},Mt={key:4,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 border border-gray-200"},Ct={key:5,class:"text-gray-500"},kt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Et={class:"fixed inset-0 z-10 overflow-y-auto"},Nt={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},At={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 border-b border-gray-100"},Rt={class:"flex justify-between items-center"},Tt={class:"px-4 sm:px-8 py-6"},Yt=z({__name:"index",setup(l){const{data:i,loading:d}=W(),{data:g,loading:o,refresh:b}=K({page:1,limit:50}),{mutate:h}=Z(),n=I(!1),r=T(()=>{const u=g.value;return u?Array.isArray(u)?u:u.data||[]:[]}),p=async u=>{confirm("Are you sure you want to cancel this request?")&&(await h(u),b())},_=()=>{n.value=!1,b()},M=["from-blue-500 to-cyan-400","from-emerald-500 to-teal-400","from-violet-500 to-purple-400","from-orange-500 to-amber-400"];return(u,s)=>{const y=B;return m(),f("div",Ge,[e("div",He,[s[6]||(s[6]=e("div",{class:"flex-1 min-w-0"},[e("h2",{class:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"}," Leave Management "),e("p",{class:"mt-1 text-sm text-gray-500"}," View your balances and track your leave requests ")],-1)),e("div",Ue,[c(y,{onClick:s[0]||(s[0]=t=>n.value=!0),class:"shadow-lg shadow-brand-navy/20"},{default:w(()=>[c(a(se),{class:"w-4 h-4 mr-2"}),s[5]||(s[5]=D(" New Request ",-1))]),_:1})])]),e("div",Ye,[a(d)?(m(),f(E,{key:0},A(3,t=>e("div",{key:t,class:"h-40 bg-gray-100 rounded-xl animate-pulse"})),64)):!a(i)||a(i).length===0?(m(),f("div",Be,[c(a(X),{class:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s[7]||(s[7]=e("h3",{class:"text-lg font-medium text-gray-900"},"No Leave Balances",-1)),s[8]||(s[8]=e("p",{class:"text-gray-500 mt-1"},"You don't have any assigned leave quotas yet.",-1))])):(m(!0),f(E,{key:2},A(a(i),(t,C)=>(m(),f("div",{key:t.id,class:ae(`relative overflow-hidden rounded-xl shadow-md transition-all duration-300 hover:shadow-lg hover:-translate-y-1 bg-gradient-to-br ${M[C%M.length]}`)},[e("div",ze,[e("div",Fe,[e("div",null,[s[9]||(s[9]=e("p",{class:"text-white/80 text-sm font-medium mb-1"},"Leave Type",-1)),e("h3",Je,v(t.leaveTypeName),1)]),e("div",Qe,[c(a(X),{class:"w-6 h-6 text-white"})])]),e("div",We,[e("div",null,[s[10]||(s[10]=e("p",{class:"text-white/80 text-xs font-medium uppercase tracking-wider"},"Remaining",-1)),e("p",Ke,v(t.remainingQuota),1)]),e("div",Ze,[e("p",qe,"Total Quota: "+v(t.totalQuota),1),e("p",et,"Used: "+v(t.usedQuota),1)])])]),s[11]||(s[11]=e("div",{class:"absolute top-0 right-0 -mt-4 -mr-4 w-24 h-24 bg-white/10 rounded-full blur-xl"},null,-1)),s[12]||(s[12]=e("div",{class:"absolute bottom-0 left-0 -mb-4 -ml-4 w-24 h-24 bg-black/10 rounded-full blur-xl"},null,-1))],2))),128))]),e("div",tt,[s[27]||(s[27]=e("div",{class:"px-6 py-5 border-b border-gray-200 bg-gray-50 flex items-center justify-between"},[e("div",null,[e("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"Recent Requests"),e("p",{class:"mt-1 text-sm text-gray-500"},"History of your leave applications")])],-1)),e("div",st,[e("table",at,[s[26]||(s[26]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Type & Reason "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Duration "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date Submitted "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{scope:"col",class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Actions")])])],-1)),e("tbody",ot,[a(o)?(m(),f(E,{key:0},A(3,t=>e("tr",{key:t},[...s[13]||(s[13]=[e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("div",{class:"h-4 bg-gray-100 rounded w-3/4 animate-pulse"})],-1),e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("div",{class:"h-4 bg-gray-100 rounded w-1/2 animate-pulse"})],-1),e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("div",{class:"h-4 bg-gray-100 rounded w-1/2 animate-pulse"})],-1),e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("div",{class:"h-4 bg-gray-100 rounded w-1/4 animate-pulse"})],-1),e("td",{class:"px-6 py-4 whitespace-nowrap text-right"},[e("div",{class:"h-4 bg-gray-100 rounded w-8 animate-pulse ml-auto"})],-1)])])),64)):r.value.length===0?(m(),f("tr",nt,[e("td",rt,[e("div",lt,[c(a(oe),{class:"w-12 h-12 text-gray-300 mb-3"}),s[15]||(s[15]=e("p",{class:"text-lg font-medium text-gray-900"},"No requests found",-1)),s[16]||(s[16]=e("p",{class:"text-sm text-gray-500 mt-1"},"You haven't applied for any leave yet.",-1)),c(y,{variant:"ghost",onClick:s[1]||(s[1]=t=>n.value=!0),class:"mt-4 text-brand-navy hover:bg-blue-50"},{default:w(()=>[s[14]||(s[14]=D(" Apply Now ",-1)),c(a(ne),{class:"w-4 h-4 ml-1"})]),_:1})])])])):(m(!0),f(E,{key:2},A(r.value,t=>(m(),f("tr",{key:t.id,class:"hover:bg-gray-50 transition-colors"},[e("td",it,[e("div",dt,[e("div",null,[e("div",ut,v(t.leaveTypeName),1),e("div",ct,v(t.reason),1)])])]),e("td",mt,[e("div",ft,v(a(U)(new Date(t.startDate),"MMM d"))+" - "+v(a(U)(new Date(t.endDate),"MMM d, yyyy")),1),e("div",pt,v(t.totalDays)+" day"+v(t.totalDays>1?"s":""),1)]),e("td",yt,v(t.submittedAt?a(Ne)(new Date(t.submittedAt),{addSuffix:!0}):"-"),1),e("td",xt,[t.status===a(k).APPROVED||t.hrApprovalStatus==="APPROVED"?(m(),f("div",vt,[e("span",gt,[c(a(j),{class:"w-3 h-3 mr-1"}),s[17]||(s[17]=D(" Approved ",-1))]),s[18]||(s[18]=e("span",{class:"text-xs text-gray-500"},"by HR",-1))])):t.status===a(k).MANAGER_APPROVED||t.managerApprovedAt&&t.hrApprovalStatus==="PENDING"?(m(),f("div",bt,[e("span",ht,[c(a(j),{class:"w-3 h-3 mr-1"}),s[19]||(s[19]=D(" Manager Approved ",-1))]),s[20]||(s[20]=e("span",{class:"text-xs text-gray-500"},"waiting for HR",-1))])):t.status===a(k).PENDING?(m(),f("div",wt,[e("span",Dt,[c(a(re),{class:"w-3 h-3 mr-1"}),s[21]||(s[21]=D(" Pending ",-1))]),s[22]||(s[22]=e("span",{class:"text-xs text-gray-500"},"waiting for Manager/HR",-1))])):t.status===a(k).REJECTED||t.hrApprovalStatus==="REJECTED"?(m(),f("span",_t,[c(a(le),{class:"w-3 h-3 mr-1"}),s[23]||(s[23]=D(" Rejected ",-1))])):t.status===a(k).CANCELLED?(m(),f("span",Mt,[c(a(ie),{class:"w-3 h-3 mr-1"}),s[24]||(s[24]=D(" Cancelled ",-1))])):(m(),f("span",Ct,v(t.status),1))]),e("td",kt,[t.status===a(k).PENDING||t.status===a(k).MANAGER_APPROVED?(m(),de(y,{key:0,variant:"destructive",class:"bg-white text-red-600 border border-red-200 hover:bg-red-50 hover:border-red-300 focus:ring-red-200 py-1 px-3 text-xs h-auto shadow-sm",onClick:C=>p(t.id)},{default:w(()=>[...s[25]||(s[25]=[D(" Cancel ",-1)])]),_:1},8,["onClick"])):N("",!0)])]))),128))])])])]),c(a(he),{as:"template",show:n.value},{default:w(()=>[c(a(ve),{as:"div",class:"relative z-50",onClose:s[4]||(s[4]=t=>n.value=!1)},{default:w(()=>[c(a(Y),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:w(()=>[...s[28]||(s[28]=[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)])]),_:1}),e("div",Et,[e("div",Nt,[c(a(Y),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:w(()=>[c(a(ge),{class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},{default:w(()=>[e("div",At,[e("div",Rt,[c(a(be),{as:"h3",class:"text-lg font-semibold leading-6 text-gray-900"},{default:w(()=>[...s[29]||(s[29]=[D("Apply for Leave",-1)])]),_:1}),e("button",{onClick:s[2]||(s[2]=t=>n.value=!1),class:"text-gray-400 hover:text-gray-500"},[c(a(ue),{class:"w-5 h-5"})])])]),e("div",Tt,[c(je,{onSuccess:_,onCancel:s[3]||(s[3]=t=>n.value=!1)})])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}});export{Yt as default};
