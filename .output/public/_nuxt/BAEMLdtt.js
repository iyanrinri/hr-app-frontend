import{_ as X,a as Z}from"./DNko07Iw.js";import{_ as ee}from"./PIMMusR-.js";import{_ as te}from"./Cb5BKmlr.js";import{_ as se}from"./CCY-pFV-.js";import{g as L,j as _,K as p,y as ae,c as r,o as u,n as le,a as e,b as s,w as n,d as w,k as y,U as ne,p as A,V as U,F,l as M,t as o,$ as oe,z as re,G as ue,Y as B,a6 as de,P as ie,a7 as me,a8 as ce}from"./DEyY0kFD.js";import{f as pe}from"./3VhWkR2T.js";import{u as ye}from"./CAATqtpM.js";import{u as xe}from"./LbrgZD77.js";import{O as ve}from"./BlBPs-ZZ.js";import"./uRmCsCMF.js";import"./DYvQZ50l.js";import"./D8dPcGoU.js";const fe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ge=["value"],be={key:0,class:"bg-gray-50 p-4 rounded-md space-y-2 text-sm"},_e={class:"flex justify-between"},we={class:"font-medium"},Se={class:"flex justify-between"},he={class:"font-medium"},De={class:"relative rounded-md shadow-sm"},Ce={class:"relative rounded-md shadow-sm"},ke={class:"flex justify-between text-sm"},Ne={class:"flex justify-between text-sm"},Pe={class:"flex justify-between text-sm"},$e={class:"text-green-600"},Ve={class:"flex justify-between text-sm"},Ie={class:"text-red-600"},Ue={class:"border-t pt-3 mt-2"},je={class:"flex justify-between font-bold text-lg"},Ee={class:"text-brand-cyan"},Oe={key:0,class:"text-center py-4 text-gray-500"},Re={key:1,class:"text-center py-4 text-gray-500"},Ae={key:2,class:"overflow-x-auto"},Fe={class:"min-w-full divide-y divide-gray-200"},Me={class:"divide-y divide-gray-200"},Be={class:"px-4 py-2"},Le=["checked","onChange"],Ye={class:"px-4 py-2 text-sm text-gray-900"},qe={class:"px-4 py-2 text-sm text-gray-900"},Te={class:"px-4 py-2 text-sm text-gray-900"},He={class:"px-4 py-2 text-sm text-gray-500 truncate max-w-xs"},ze={class:"flex justify-end space-x-4"},Ge=["disabled"],Ke={key:0,class:"mr-2"},Je=L({__name:"CreatePayrollForm",props:{isSubmitting:{type:Boolean}},emits:["success","cancel"],setup(j,{emit:C}){const V=C,k=j,S=(()=>{const a=new Date,t=new Date(a.getFullYear(),a.getMonth(),1),f=new Date(a.getFullYear(),a.getMonth()+1,0),c=m=>{const g=m.getFullYear(),$=String(m.getMonth()+1).padStart(2,"0"),l=String(m.getDate()).padStart(2,"0");return`${g}-${$}-${l}`};return{start:c(t),end:c(f)}})(),d=_(""),x=_(S.start),b=_(S.end),h=_("0"),D=_("0"),i=_([]),{data:E}=ye(),q=p(()=>{if(!(!d.value||!x.value||!b.value))return{employeeId:d.value,startDate:x.value,endDate:b.value,status:ve.APPROVED,take:100}}),{data:T,loading:H}=xe(q),N=p(()=>{const a=T.value;return a?Array.isArray(a)?a:a.requests||[]:[]}),P=p(()=>E.value?.find(a=>String(a.id)===d.value));ae(N,a=>{a.length>0?i.value=a.map(t=>t.id):i.value=[]});const O=p(()=>Number(P.value?.baseSalary)||0),R=p(()=>N.value.filter(a=>i.value.includes(a.id)).reduce((a,t)=>a+(Number(t.calculatedAmount)||0),0)),z=p(()=>O.value+R.value+Number(D.value)),G=p(()=>z.value-Number(h.value)),v=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}).format(a),{mutate:K,loading:J}=pe(),I=p(()=>k.isSubmitting||J.value),Q=async()=>{d.value&&await K({employeeId:d.value,periodStart:new Date(x.value).toISOString(),periodEnd:new Date(b.value).toISOString(),deductions:h.value,bonuses:D.value,overtimeRequestIds:i.value},{onSuccess:()=>V("success")})},W=a=>{i.value.includes(a)?i.value=i.value.filter(t=>t!==a):i.value.push(a)};return(a,t)=>{const f=Z,c=X,m=ee,g=te,$=se;return u(),r("form",{onSubmit:le(Q,["prevent"]),class:"space-y-6"},[e("div",fe,[s(g,null,{default:n(()=>[s(c,null,{default:n(()=>[s(f,{class:"flex items-center text-lg"},{default:n(()=>[s(y(ne),{class:"mr-2 h-5 w-5 text-gray-500"}),t[6]||(t[6]=w(" Employee Details ",-1))]),_:1})]),_:1}),s(m,{class:"space-y-4"},{default:n(()=>[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-bold text-gray-700 mb-1"},"Select Employee",-1)),U(e("select",{class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-brand-cyan focus:border-brand-cyan","onUpdate:modelValue":t[0]||(t[0]=l=>d.value=l)},[t[7]||(t[7]=e("option",{value:""},"-- Select Employee --",-1)),(u(!0),r(F,null,M(y(E),l=>(u(),r("option",{key:l.id,value:l.id},o(l.firstName)+" "+o(l.lastName)+" ("+o(l.position)+") ",9,ge))),128))],512),[[oe,d.value]])]),P.value?(u(),r("div",be,[e("div",_e,[t[9]||(t[9]=e("span",{class:"text-gray-500"},"Department:",-1)),e("span",we,o(P.value.department),1)]),e("div",Se,[t[10]||(t[10]=e("span",{class:"text-gray-500"},"Base Salary:",-1)),e("span",he,o(v(P.value.baseSalary)),1)])])):A("",!0)]),_:1})]),_:1}),s(g,null,{default:n(()=>[s(c,null,{default:n(()=>[s(f,{class:"flex items-center text-lg"},{default:n(()=>[s(y(re),{class:"mr-2 h-5 w-5 text-gray-500"}),t[11]||(t[11]=w(" Payroll Period ",-1))]),_:1})]),_:1}),s(m,{class:"space-y-4"},{default:n(()=>[s($,{type:"date",label:"Period Start",modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=l=>x.value=l),required:""},null,8,["modelValue"]),s($,{type:"date",label:"Period End",modelValue:b.value,"onUpdate:modelValue":t[2]||(t[2]=l=>b.value=l),min:x.value,required:""},null,8,["modelValue","min"])]),_:1})]),_:1}),s(g,null,{default:n(()=>[s(c,null,{default:n(()=>[s(f,{class:"flex items-center text-lg"},{default:n(()=>[s(y(ue),{class:"mr-2 h-5 w-5 text-gray-500"}),t[12]||(t[12]=w(" Adjustments ",-1))]),_:1})]),_:1}),s(m,{class:"space-y-4"},{default:n(()=>[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Bonuses",-1)),e("div",De,[t[13]||(t[13]=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"Rp")],-1)),U(e("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=l=>D.value=l),class:"block w-full rounded-md border-gray-300 pl-10 focus:border-brand-cyan focus:ring-brand-cyan sm:text-sm h-10 border",min:"0"},null,512),[[B,D.value]])])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Deductions",-1)),e("div",Ce,[t[15]||(t[15]=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("span",{class:"text-gray-500 sm:text-sm"},"Rp")],-1)),U(e("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=l=>h.value=l),class:"block w-full rounded-md border-gray-300 pl-10 focus:border-brand-cyan focus:ring-brand-cyan sm:text-sm h-10 border",min:"0"},null,512),[[B,h.value]])])])]),_:1})]),_:1}),s(g,null,{default:n(()=>[s(c,null,{default:n(()=>[s(f,{class:"flex items-center text-lg"},{default:n(()=>[s(y(de),{class:"mr-2 h-5 w-5 text-gray-500"}),t[17]||(t[17]=w(" Calculated Salary ",-1))]),_:1})]),_:1}),s(m,{class:"space-y-3"},{default:n(()=>[e("div",ke,[t[18]||(t[18]=e("span",{class:"text-gray-600"},"Base Salary:",-1)),e("span",null,o(v(O.value)),1)]),e("div",Ne,[t[19]||(t[19]=e("span",{class:"text-gray-600"},"Overtime Pay:",-1)),e("span",null,o(v(R.value)),1)]),e("div",Pe,[t[20]||(t[20]=e("span",{class:"text-gray-600"},"Bonuses:",-1)),e("span",$e,"+ "+o(v(Number(D.value))),1)]),e("div",Ve,[t[21]||(t[21]=e("span",{class:"text-gray-600"},"Deductions:",-1)),e("span",Ie,"- "+o(v(Number(h.value))),1)]),e("div",Ue,[e("div",je,[t[22]||(t[22]=e("span",null,"Net Salary:",-1)),e("span",Ee,o(v(G.value)),1)])])]),_:1})]),_:1})]),s(g,null,{default:n(()=>[s(c,null,{default:n(()=>[s(f,{class:"flex items-center text-lg"},{default:n(()=>[s(y(ie),{class:"mr-2 h-5 w-5 text-gray-500"}),t[23]||(t[23]=w(" Approved Overtime Requests ",-1))]),_:1})]),_:1}),s(m,null,{default:n(()=>[y(H)?(u(),r("div",Oe,"Loading overtime requests...")):N.value.length===0?(u(),r("div",Re,o(d.value&&x.value&&b.value?"No approved overtime requests found for this period.":"Select Employee and Period to view overtime requests."),1)):(u(),r("div",Ae,[e("table",Fe,[t[24]||(t[24]=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Include"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Date"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Hours"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Amount"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Reason")])],-1)),e("tbody",Me,[(u(!0),r(F,null,M(N.value,l=>(u(),r("tr",{key:l.id,class:"hover:bg-gray-50"},[e("td",Be,[e("input",{type:"checkbox",checked:i.value.includes(l.id),onChange:Ze=>W(l.id),class:"h-4 w-4 text-brand-cyan focus:ring-brand-cyan border-gray-300 rounded"},null,40,Le)]),e("td",Ye,o(new Date(l.date).toLocaleDateString()),1),e("td",qe,o((l.totalMinutes/60).toFixed(1))+" hrs ",1),e("td",Te,o(v(Number(l.calculatedAmount)||0)),1),e("td",He,o(l.reason),1)]))),128))])])]))]),_:1})]),_:1}),e("div",ze,[e("button",{type:"button",onClick:t[5]||(t[5]=l=>a.$emit("cancel")),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," Cancel "),e("button",{type:"submit",disabled:I.value||!d.value,class:"px-4 py-2 text-sm font-medium text-white bg-brand-navy rounded-md hover:opacity-90 disabled:opacity-50 flex items-center"},[I.value?(u(),r("span",Ke,"...")):A("",!0),w(" "+o(I.value?"Creating Payroll...":"Create Payroll"),1)],8,Ge)])],32)}}}),Qe={class:"space-y-6 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},We={class:"md:flex md:items-center md:justify-between"},Xe={class:"flex items-center min-w-0"},ct=L({__name:"create",setup(j){const C=me(),V=()=>{C.push({path:"."})},k=()=>{C.back()};return(Y,S)=>(u(),r("div",Qe,[e("div",We,[e("div",Xe,[e("button",{onClick:k,class:"mr-4 text-gray-400 hover:text-gray-500"},[s(y(ce),{class:"w-6 h-6"})]),S[0]||(S[0]=e("div",null,[e("h2",{class:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate"}," Create New Payroll "),e("p",{class:"mt-1 text-sm text-gray-500"}," Calculate salary and generate payroll entry ")],-1))])]),s(Je,{onSuccess:V,onCancel:k})]))}});export{ct as default};
