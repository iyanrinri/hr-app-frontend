import{_ as J}from"./Zw0ZmG7K.js";import{_ as Q,a as X}from"./DNko07Iw.js";import{_ as Y}from"./CCY-pFV-.js";import{_ as Z}from"./DMChQONX.js";import{_ as ee}from"./PIMMusR-.js";import{_ as te}from"./Cb5BKmlr.js";import{aw as U,K as E,k as d,j as V,x as L,g as ae,a7 as le,y as oe,c,a as t,b as l,w as i,F as q,o as y,d as g,a8 as se,n as ne,V as k,aU as _,t as T,a1 as re,p as S,l as ie,z as de,H as ue}from"./DEyY0kFD.js";import{u as me,a as pe}from"./BbZJfKnN.js";import{u as ce}from"./DYvQZ50l.js";import"./BV-bnHA6.js";import"./uRmCsCMF.js";import"./D8dPcGoU.js";const P=()=>{const m=L().params.tenant_slug;return n=>{const x=n.startsWith("/")?n:`/${n}`;return m?`/api/${m}${x}`:`/api${x}`}},ye=f=>{const m=P(),n=U(),{data:x,pending:p,error:v,refresh:D}=ce(()=>m("/attendance-periods/holidays/list"),{key:`holidays-${d(f)}`,query:E(()=>({attendancePeriodId:d(f)})),immediate:!!d(f),headers:E(()=>({Authorization:`Bearer ${n.token}`}))},"$9Uuuwc77my");return{data:x,loading:p,error:v,refresh:D}},fe=()=>{const f=P(),m=U(),n=V(!1);return{mutate:async p=>{n.value=!0;try{await $fetch(f("/attendance-periods/holidays"),{method:"POST",body:p,headers:{Authorization:`Bearer ${m.token}`}})}catch(v){throw v}finally{n.value=!1}},loading:n}},ge=()=>{const f=P(),m=U(),n=V(!1);return{mutate:async p=>{n.value=!0;try{await $fetch(f(`/attendance-periods/holidays/${p}`),{method:"DELETE",headers:{Authorization:`Bearer ${m.token}`}})}catch(v){throw v}finally{n.value=!1}},loading:n}},xe={class:"space-y-6 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ve={class:"flex items-center space-x-4"},we={key:0,class:"text-center py-12"},be={key:1,class:"text-center py-12 text-red-500"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},_e={class:"md:col-span-2"},Ve={class:"md:col-span-2 space-y-3"},De={class:"flex items-center space-x-2"},he={class:"flex items-center space-x-2"},Te={class:"md:col-span-2"},Se={class:"md:col-span-2"},Ue={class:"flex items-center space-x-2"},Pe={class:"flex justify-end space-x-4"},He={key:0,class:"mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50"},We={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},$e={class:"md:col-span-2"},Ae={class:"flex items-center space-x-4"},Ce={class:"flex items-center space-x-2"},Me={class:"flex items-center space-x-2"},Ne={class:"flex justify-end space-x-2 mt-4"},Ee={class:"overflow-x-auto"},qe={class:"min-w-full divide-y divide-gray-200"},Le={class:"bg-white divide-y divide-gray-200"},Be={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Re={class:"flex items-center"},Fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},je={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ze={class:"flex gap-2"},Oe={key:0,class:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded"},Ie={key:1,class:"px-2 py-1 text-xs font-medium bg-purple-100 text-purple-800 rounded"},Ke={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ge={key:1},it=ae({__name:"[id]",setup(f){const m=L(),n=le(),x=m.params.tenant_slug,p=m.params.id,{data:v,loading:D,error:B}=me(p),{mutate:R,loading:H}=pe(),{data:h,refresh:W}=ye(p),{mutate:F}=fe(),{mutate:j}=ge(),o=V({name:"",startDate:"",endDate:"",workingDaysPerWeek:5,workingHoursPerDay:8,workingStartTime:"",workingEndTime:"",allowSaturdayWork:!1,allowSundayWork:!1,lateToleranceMinutes:0,earlyLeaveToleranceMinutes:0,description:"",isActive:!1});oe(v,s=>{s&&(o.value={name:s.name,startDate:s.startDate.split("T")[0],endDate:s.endDate.split("T")[0],workingDaysPerWeek:s.workingDaysPerWeek,workingHoursPerDay:s.workingHoursPerDay,workingStartTime:s.workingStartTime,workingEndTime:s.workingEndTime,allowSaturdayWork:s.allowSaturdayWork,allowSundayWork:s.allowSundayWork,lateToleranceMinutes:s.lateToleranceMinutes,earlyLeaveToleranceMinutes:s.earlyLeaveToleranceMinutes,description:s.description||"",isActive:s.isActive})},{immediate:!0});const $=()=>{n.push(`/${x}/dashboard/attendance-periods`)},z=async()=>{if(!o.value.name||!o.value.startDate||!o.value.endDate){alert("Please fill in all required fields");return}const s={...o.value};try{await R(p,s),alert("Attendance period updated successfully")}catch(e){console.error(e),alert("Failed to update attendance period")}},b=V(!1),r=V({name:"",date:"",isNational:!1,isRecurring:!1,description:""}),O=async()=>{if(!r.value.name||!r.value.date){alert("Name and Date are required");return}try{await F({...r.value,attendancePeriodId:p,description:r.value.description||null}),r.value={name:"",date:"",isNational:!1,isRecurring:!1,description:""},b.value=!1,W()}catch(s){console.error(s),alert("Failed to add holiday")}},I=async s=>{confirm("Are you sure you want to remove this holiday?")&&(await j(s),W())},K=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(s,e)=>{const w=J,A=X,C=Q,u=Y,G=Z,M=ee,N=te;return y(),c("div",xe,[t("div",ve,[l(w,{variant:"ghost",onClick:$},{default:i(()=>[l(d(se),{class:"w-4 h-4 mr-2"}),e[20]||(e[20]=g(" Back ",-1))]),_:1}),e[21]||(e[21]=t("h2",{class:"text-2xl font-bold text-gray-900"},"Edit Attendance Period",-1))]),d(D)?(y(),c("div",we,"Loading...")):d(B)||!d(v)?(y(),c("div",be,"Error loading period details")):(y(),c(q,{key:2},[l(N,null,{default:i(()=>[l(C,null,{default:i(()=>[l(A,null,{default:i(()=>[...e[22]||(e[22]=[g("Period Details",-1)])]),_:1})]),_:1}),l(M,null,{default:i(()=>[t("form",{onSubmit:ne(z,["prevent"]),class:"space-y-6"},[t("div",ke,[t("div",_e,[l(u,{label:"Period Name",modelValue:o.value.name,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.name=a),required:""},null,8,["modelValue"])]),l(u,{label:"Start Date",type:"date",modelValue:o.value.startDate,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.startDate=a),required:""},null,8,["modelValue"]),l(u,{label:"End Date",type:"date",modelValue:o.value.endDate,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.endDate=a),required:""},null,8,["modelValue"]),l(u,{label:"Working Days Per Week",type:"number",min:"1",max:"7",modelValue:o.value.workingDaysPerWeek,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.workingDaysPerWeek=a),modelModifiers:{number:!0},required:""},null,8,["modelValue"]),l(u,{label:"Working Hours Per Day",type:"number",min:"1",max:"24",modelValue:o.value.workingHoursPerDay,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.workingHoursPerDay=a),modelModifiers:{number:!0},required:""},null,8,["modelValue"]),l(u,{label:"Working Start Time",type:"time",modelValue:o.value.workingStartTime,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.workingStartTime=a),required:""},null,8,["modelValue"]),l(u,{label:"Working End Time",type:"time",modelValue:o.value.workingEndTime,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.workingEndTime=a),required:""},null,8,["modelValue"]),l(u,{label:"Late Tolerance (Minutes)",type:"number",min:"0",max:"120",modelValue:o.value.lateToleranceMinutes,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.lateToleranceMinutes=a),modelModifiers:{number:!0},required:""},null,8,["modelValue"]),l(u,{label:"Early Leave Tolerance (Minutes)",type:"number",min:"0",max:"120",modelValue:o.value.earlyLeaveToleranceMinutes,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.earlyLeaveToleranceMinutes=a),modelModifiers:{number:!0},required:""},null,8,["modelValue"]),t("div",Ve,[t("label",De,[k(t("input",{type:"checkbox",class:"w-4 h-4 text-brand-navy border-gray-600 rounded focus:ring-brand-cyan","onUpdate:modelValue":e[9]||(e[9]=a=>o.value.allowSaturdayWork=a)},null,512),[[_,o.value.allowSaturdayWork]]),e[23]||(e[23]=t("span",{class:"text-sm font-medium text-gray-900"},"Allow Saturday Work",-1))]),t("label",he,[k(t("input",{type:"checkbox",class:"w-4 h-4 text-brand-navy border-gray-600 rounded focus:ring-brand-cyan","onUpdate:modelValue":e[10]||(e[10]=a=>o.value.allowSundayWork=a)},null,512),[[_,o.value.allowSundayWork]]),e[24]||(e[24]=t("span",{class:"text-sm font-medium text-gray-900"},"Allow Sunday Work",-1))])]),t("div",Te,[l(G,{label:"Description",placeholder:"Optional description for this period",modelValue:o.value.description,"onUpdate:modelValue":e[11]||(e[11]=a=>o.value.description=a)},null,8,["modelValue"])]),t("div",Se,[t("label",Ue,[k(t("input",{type:"checkbox",class:"w-4 h-4 text-brand-navy border-gray-600 rounded focus:ring-brand-cyan","onUpdate:modelValue":e[12]||(e[12]=a=>o.value.isActive=a)},null,512),[[_,o.value.isActive]]),e[25]||(e[25]=t("span",{class:"text-sm font-medium text-gray-900"},"Active Period",-1))])])]),t("div",Pe,[l(w,{type:"button",variant:"secondary",onClick:$},{default:i(()=>[...e[26]||(e[26]=[g(" Cancel ",-1)])]),_:1}),l(w,{type:"submit",disabled:d(H)},{default:i(()=>[g(T(d(H)?"Saving...":"Save Changes"),1)]),_:1},8,["disabled"])])],32)]),_:1})]),_:1}),l(N,null,{default:i(()=>[l(C,{class:"flex flex-row items-center justify-between"},{default:i(()=>[l(A,null,{default:i(()=>[...e[27]||(e[27]=[g("Holidays",-1)])]),_:1}),l(w,{onClick:e[13]||(e[13]=a=>b.value=!b.value)},{default:i(()=>[l(d(re),{class:"w-4 h-4 mr-2"}),e[28]||(e[28]=g(" Add Holiday ",-1))]),_:1})]),_:1}),l(M,null,{default:i(()=>[b.value?(y(),c("div",He,[e[33]||(e[33]=t("h4",{class:"font-bold text-gray-900 mb-4"},"New Holiday",-1)),t("div",We,[l(u,{label:"Holiday Name",modelValue:r.value.name,"onUpdate:modelValue":e[14]||(e[14]=a=>r.value.name=a)},null,8,["modelValue"]),l(u,{label:"Date",type:"date",modelValue:r.value.date,"onUpdate:modelValue":e[15]||(e[15]=a=>r.value.date=a)},null,8,["modelValue"]),t("div",$e,[l(u,{label:"Description",modelValue:r.value.description,"onUpdate:modelValue":e[16]||(e[16]=a=>r.value.description=a)},null,8,["modelValue"])]),t("div",Ae,[t("label",Ce,[k(t("input",{type:"checkbox",class:"w-4 h-4 text-brand-navy border-gray-600 rounded focus:ring-brand-cyan","onUpdate:modelValue":e[17]||(e[17]=a=>r.value.isNational=a)},null,512),[[_,r.value.isNational]]),e[29]||(e[29]=t("span",{class:"text-sm font-medium text-gray-900"},"National Holiday",-1))]),t("label",Me,[k(t("input",{type:"checkbox",class:"w-4 h-4 text-brand-navy border-gray-600 rounded focus:ring-brand-cyan","onUpdate:modelValue":e[18]||(e[18]=a=>r.value.isRecurring=a)},null,512),[[_,r.value.isRecurring]]),e[30]||(e[30]=t("span",{class:"text-sm font-medium text-gray-900"},"Recurring",-1))])])]),t("div",Ne,[l(w,{variant:"secondary",onClick:e[19]||(e[19]=a=>b.value=!1)},{default:i(()=>[...e[31]||(e[31]=[g(" Cancel ",-1)])]),_:1}),l(w,{onClick:O},{default:i(()=>[...e[32]||(e[32]=[g(" Add Holiday ",-1)])]),_:1})])])):S("",!0),t("div",Ee,[t("table",qe,[e[35]||(e[35]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Name"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Type"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),t("tbody",Le,[d(h)&&d(h).length>0?(y(!0),c(q,{key:0},ie(d(h),a=>(y(),c("tr",{key:a.id,class:"hover:bg-gray-50"},[t("td",Be,[t("div",Re,[l(d(de),{class:"w-4 h-4 mr-2 text-gray-400"}),g(" "+T(a.name),1)])]),t("td",Fe,T(K(a.date)),1),t("td",je,[t("div",ze,[a.isNational?(y(),c("span",Oe," National ")):S("",!0),a.isRecurring?(y(),c("span",Ie," Recurring ")):S("",!0)])]),t("td",Ke,[l(w,{variant:"danger",class:"p-2",onClick:Je=>I(a.id),title:"Delete Holiday"},{default:i(()=>[l(d(ue),{class:"w-4 h-4"})]),_:1},8,["onClick"])])]))),128)):(y(),c("tr",Ge,[...e[34]||(e[34]=[t("td",{colspan:"4",class:"px-6 py-8 text-center text-gray-500"}," No holidays configured for this period ",-1)])]))])])])]),_:1})]),_:1})],64))])}}});export{it as default};
