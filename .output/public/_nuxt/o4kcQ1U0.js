import{_ as M}from"./Zw0ZmG7K.js";import{_ as z,a as H}from"./DNko07Iw.js";import{_ as S}from"./CCY-pFV-.js";import{_ as K}from"./PIMMusR-.js";import{_ as X}from"./Cb5BKmlr.js";import{g as I,j as C,c as i,p as L,a as e,b as o,k as n,n as j,V as w,aU as B,Y as Q,w as r,o as u,X as G,d as x,K as J,br as W,aY as Z,F as h,bs as ee,a8 as te,a1 as ae,l as se,t as f,aR as oe}from"./DEyY0kFD.js";import{l as le,m as de,n as ne,a as re,o as ie}from"./DPFRp8Kn.js";import"./BV-bnHA6.js";import"./uRmCsCMF.js";import"./DYvQZ50l.js";import"./D8dPcGoU.js";const ue={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4"},me={class:"bg-white rounded-lg shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto"},pe={class:"p-6 border-b flex justify-between items-center"},ve={class:"p-6"},ye={class:"grid grid-cols-2 gap-4"},ce={class:"grid grid-cols-3 gap-4"},fe={class:"space-y-2 p-3 bg-gray-50 rounded border"},xe={class:"flex items-center gap-2"},ge={key:0},be={class:"space-y-1"},_e={class:"flex justify-end gap-3 pt-4"},Ce=I({__name:"LeaveTypeModal",props:{isOpen:{type:Boolean},leavePeriodId:{}},emits:["close","created"],setup(V,{emit:g}){const D=V,y=g,{mutate:m,loading:k}=le(),l=C({type:"",name:"",description:"",defaultQuota:12,maxConsecutiveDays:5,advanceNoticeDays:3,isCarryForward:!1,maxCarryForward:0,isActive:!0}),v=C({}),U=()=>(v.value={},(!l.value.type||l.value.type.length<2)&&(v.value.type="Code required (e.g. ANNUAL)"),(!l.value.name||l.value.name.length<2)&&(v.value.name="Name required"),Object.keys(v.value).length===0),$=async()=>{if(U())try{await m({...l.value,leavePeriodId:D.leavePeriodId}),y("created"),y("close")}catch{}};return(c,a)=>{const p=S,b=M;return V.isOpen?(u(),i("div",ue,[e("div",me,[e("div",pe,[a[10]||(a[10]=e("h3",{class:"text-lg font-bold"},"Add Leave Type",-1)),e("button",{onClick:a[0]||(a[0]=s=>c.$emit("close")),class:"text-gray-500 hover:text-gray-700"},[o(n(G),{class:"w-5 h-5"})])]),e("div",ve,[e("form",{onSubmit:j($,["prevent"]),class:"space-y-4"},[e("div",ye,[o(p,{label:"Type Code (e.g. ANNUAL)",modelValue:l.value.type,"onUpdate:modelValue":a[1]||(a[1]=s=>l.value.type=s),error:v.value.type},null,8,["modelValue","error"]),o(p,{label:"Display Name",modelValue:l.value.name,"onUpdate:modelValue":a[2]||(a[2]=s=>l.value.name=s),error:v.value.name},null,8,["modelValue","error"])]),e("div",ce,[o(p,{label:"Default Quota",type:"number",modelValue:l.value.defaultQuota,"onUpdate:modelValue":a[3]||(a[3]=s=>l.value.defaultQuota=s),modelModifiers:{number:!0}},null,8,["modelValue"]),o(p,{label:"Max Consec.",type:"number",modelValue:l.value.maxConsecutiveDays,"onUpdate:modelValue":a[4]||(a[4]=s=>l.value.maxConsecutiveDays=s),modelModifiers:{number:!0}},null,8,["modelValue"]),o(p,{label:"Adv. Notice",type:"number",modelValue:l.value.advanceNoticeDays,"onUpdate:modelValue":a[5]||(a[5]=s=>l.value.advanceNoticeDays=s),modelModifiers:{number:!0}},null,8,["modelValue"])]),e("div",fe,[e("label",xe,[w(e("input",{type:"checkbox","onUpdate:modelValue":a[6]||(a[6]=s=>l.value.isCarryForward=s),class:"rounded border-gray-300"},null,512),[[B,l.value.isCarryForward]]),a[11]||(a[11]=e("span",{class:"text-sm font-medium"},"Allow Carry Forward?",-1))]),l.value.isCarryForward?(u(),i("div",ge,[o(p,{label:"Max Carry Fwd Days",type:"number",modelValue:l.value.maxCarryForward,"onUpdate:modelValue":a[7]||(a[7]=s=>l.value.maxCarryForward=s),modelModifiers:{number:!0}},null,8,["modelValue"])])):L("",!0)]),e("div",be,[a[12]||(a[12]=e("label",{class:"text-sm font-medium"},"Description",-1)),w(e("textarea",{class:"w-full border rounded p-2 text-sm","onUpdate:modelValue":a[8]||(a[8]=s=>l.value.description=s)},null,512),[[Q,l.value.description]])]),e("div",_e,[o(b,{type:"button",variant:"ghost",onClick:a[9]||(a[9]=s=>c.$emit("close"))},{default:r(()=>[...a[13]||(a[13]=[x("Cancel",-1)])]),_:1}),o(b,{type:"submit",disabled:n(k)},{default:r(()=>[...a[14]||(a[14]=[x("Create Type",-1)])]),_:1},8,["disabled"])])],32)])])])):L("",!0)}}}),we={class:"space-y-8"},Ve={key:0,class:"p-8 text-center"},De={key:1,class:"p-8 text-center text-red-500"},ke={class:"flex items-center gap-4"},Ue={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},$e={class:"flex items-end pb-2"},Te={class:"flex items-center gap-2 cursor-pointer"},Ne={class:"space-y-1"},Le={class:"flex justify-end"},Ae={class:"space-y-4"},Pe={class:"flex justify-between items-center"},Fe={class:"w-full text-sm text-left"},he={class:"divide-y"},Me={key:0},Se={key:1},Ie={class:"px-4 py-3 font-mono text-xs"},je={class:"px-4 py-3 font-medium"},Be={class:"px-4 py-3"},Qe={class:"px-4 py-3 text-xs text-gray-500 space-y-1"},Oe={key:0,class:"text-green-600"},Ee={class:"px-4 py-3 text-right"},tt=I({__name:"index",setup(V){const g=W(),D=ee(),y=J(()=>Number(g.params.id));g.params.tenant_slug;const{data:m,loading:k,refresh:l,error:v}=de(y),{mutate:U,loading:$}=ne(),{data:c,loading:a,refresh:p}=re(y),{mutate:b}=ie(),s=C({name:"",startDate:"",endDate:"",description:"",isActive:!1}),T=C(!1);Z(()=>{m.value&&(s.value={name:m.value.name,startDate:m.value.startDate.split("T")[0],endDate:m.value.endDate.split("T")[0],description:m.value.description,isActive:m.value.isActive})});const O=async()=>{await U(y.value,s.value),l()},E=async A=>{confirm("Delete this leave type?")&&(await b(A),p())},R=()=>{p()};return(A,t)=>{const _=M,q=H,Y=z,N=S,P=K,F=X;return u(),i("div",we,[n(k)?(u(),i("div",Ve,"Loading...")):n(v)||!n(m)?(u(),i("div",De,"Period not found")):(u(),i(h,{key:2},[e("div",ke,[o(_,{variant:"ghost",onClick:t[0]||(t[0]=d=>n(D).back())},{default:r(()=>[o(n(te),{class:"w-4 h-4 mr-2"}),t[8]||(t[8]=x(" Back ",-1))]),_:1}),t[9]||(t[9]=e("h2",{class:"text-2xl font-bold text-gray-900"},"Edit Leave Period",-1))]),o(F,null,{default:r(()=>[o(Y,null,{default:r(()=>[o(q,null,{default:r(()=>[...t[10]||(t[10]=[x("Configuration",-1)])]),_:1})]),_:1}),o(P,null,{default:r(()=>[e("form",{onSubmit:j(O,["prevent"]),class:"space-y-6"},[e("div",Ue,[o(N,{label:"Period Name",modelValue:s.value.name,"onUpdate:modelValue":t[1]||(t[1]=d=>s.value.name=d)},null,8,["modelValue"]),e("div",$e,[e("label",Te,[w(e("input",{type:"checkbox",class:"w-5 h-5 rounded border-gray-300 text-brand-navy focus:ring-brand-navy","onUpdate:modelValue":t[2]||(t[2]=d=>s.value.isActive=d)},null,512),[[B,s.value.isActive]]),t[11]||(t[11]=e("span",{class:"text-sm font-medium text-gray-700"},"Set as Active Period",-1))])]),o(N,{label:"Start Date",type:"date",modelValue:s.value.startDate,"onUpdate:modelValue":t[3]||(t[3]=d=>s.value.startDate=d)},null,8,["modelValue"]),o(N,{label:"End Date",type:"date",modelValue:s.value.endDate,"onUpdate:modelValue":t[4]||(t[4]=d=>s.value.endDate=d)},null,8,["modelValue"])]),e("div",Ne,[t[12]||(t[12]=e("label",{class:"text-sm font-medium text-gray-700"},"Description",-1)),w(e("textarea",{class:"w-full min-h-[80px] border border-gray-300 rounded-md p-2","onUpdate:modelValue":t[5]||(t[5]=d=>s.value.description=d)},null,512),[[Q,s.value.description]])]),e("div",Le,[o(_,{type:"submit",disabled:n($)},{default:r(()=>[...t[13]||(t[13]=[x("Save Changes",-1)])]),_:1},8,["disabled"])])],32)]),_:1})]),_:1}),e("div",Ae,[e("div",Pe,[t[15]||(t[15]=e("h3",{class:"text-xl font-bold text-gray-800"},"Leave Types & Quotas",-1)),o(_,{onClick:t[6]||(t[6]=d=>T.value=!0)},{default:r(()=>[o(n(ae),{class:"w-4 h-4 mr-2"}),t[14]||(t[14]=x(" Add Leave Type ",-1))]),_:1})]),o(F,null,{default:r(()=>[o(P,{class:"p-0 overflow-hidden"},{default:r(()=>[e("table",Fe,[t[18]||(t[18]=e("thead",{class:"bg-gray-50 border-b"},[e("tr",null,[e("th",{class:"px-4 py-3 font-medium text-gray-500"},"Code"),e("th",{class:"px-4 py-3 font-medium text-gray-500"},"Name"),e("th",{class:"px-4 py-3 font-medium text-gray-500"},"Quota"),e("th",{class:"px-4 py-3 font-medium text-gray-500"},"Settings"),e("th",{class:"px-4 py-3 font-medium text-right text-gray-500"},"Action")])],-1)),e("tbody",he,[n(a)?(u(),i("tr",Me,[...t[16]||(t[16]=[e("td",{colspan:"5",class:"p-4 text-center"},"Loading types...",-1)])])):!n(c)||n(c).length===0?(u(),i("tr",Se,[...t[17]||(t[17]=[e("td",{colspan:"5",class:"p-4 text-center text-gray-500 italic"},"No leave types defined.",-1)])])):(u(!0),i(h,{key:2},se(n(c),d=>(u(),i("tr",{key:d.id,class:"hover:bg-gray-50"},[e("td",Ie,f(d.type),1),e("td",je,f(d.name),1),e("td",Be,f(d.defaultQuota)+" Days",1),e("td",Qe,[e("div",null,"Max Consec: "+f(d.maxConsecutiveDays)+"d",1),e("div",null,"Notice: "+f(d.advanceNoticeDays)+"d",1),d.isCarryForward?(u(),i("div",Oe,"Carry Fwd: "+f(d.maxCarryForward)+"d",1)):L("",!0)]),e("td",Ee,[o(_,{variant:"destructive",class:"h-8 px-2",onClick:Re=>E(d.id)},{default:r(()=>[o(n(oe),{class:"w-4 h-4"})]),_:1},8,["onClick"])])]))),128))])])]),_:1})]),_:1})]),o(Ce,{isOpen:T.value,leavePeriodId:y.value,onClose:t[7]||(t[7]=d=>T.value=!1),onCreated:R},null,8,["isOpen","leavePeriodId"])],64))])}}});export{tt as default};
